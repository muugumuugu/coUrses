
xy/device is an adapted version of code written by @fogelman

It is reproduced here with permission. 

