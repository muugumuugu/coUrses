<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Chrome Extensions | Daniel Shiffman</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    
    
    <script src="js/jquery.js"></script>
    <script src="js/main.js"></script>
    
</head>


  <body>

    


      <link rel="stylesheet" type="text/css" href="css/prism.css">
<link rel="stylesheet" type="text/css" href="css/highlight.css">
<link rel="stylesheet" type="text/css" href="css/a2z.css">
<script src="js/blog.js"></script>
<script src="js/prism.js"></script>

<section class="left-container out a2z">
  <h1>Programming from A to Z</h1>
  <p><br/>

    <a href="index.html" class="body-link primary">about</a> 
    <a href="../A2Z-F16/README.md" class="body-link primary">syllabus</a>
    <a href="../A2Z-F16" class="body-link primary">All example source code</a>

  </p>
  <span class="line-charm first"></span>
  <div class="content-wrapper article a2z">
    <h2 id="chrome-extensions-and-bookmarklets">Chrome Extensions (and Bookmarklets)</h2>

<iframe width="560" height="315" src="https://www.youtube.com/embed/hkOTAmmuv_4?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<h3 id="example-extensions">Example extensions</h3>
<ul>
  <li><a href="../A2Z-F17/week10-chrome-ext/00_extension_basics_browser">Basic “hello world” extension – Browser Action</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/01_extension_basics_page">Basic “hello world” extension – Page action</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/02_extension_browser_popup_p5">Extension with pop-up (using p5)</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/03_extension_browser_popup_messaging">Extension with pop-up controlling content</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/04_extension_browser_popup_messaging_2">Extension with pop-up querying wordnik</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/05_content_changer">Image swap and content altering</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/06_with_p5">Content script with p5 canvas overlay</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/07_word_redacter">Searching and redacting a word</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/08_override">Override “new tab”</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/09_omnibox">OmniBox</a></li>
  <li><a href="../A2Z-F17/week10-chrome-ext/10_alarms">Alarms</a></li>
</ul>

<h3 id="examples-of-creative-extensions">Examples of Creative Extensions</h3>
<ul>
  <li><a href="https://melanie-hoff.com/DECODELIA/">decodelia</a></li>
  <li><a href="https://github.com/wheresaddie/girlsvsgit">girlsvsgit</a> by <a href="https://twitter.com/wheresaddie">wheresaddie</a></li>
  <li><a href="http://pleaseenjoy.com/projects/personal/wordless-web/#image454">wordless web</a> (this is actually a bookmarklet but as a content script could be an extension).</li>
  <li><a href="http://codedoodl.es/">code doodles</a></li>
</ul>

<h3 id="resources--tutorials">Resources / Tutorials</h3>
<ul>
  <li><a href="https://developer.chrome.com/extensions/getstarted">Official Google guide to chrome extensions</a></li>
  <li><a href="https://www.youtube.com/watch?v=pT-b2SpFIWo">Building your first chrome extension video tutorial</a></li>
  <li><a href="https://robots.thoughtbot.com/how-to-make-a-chrome-extension">How to make a chrome extension</a></li>
  <li><a href="http://code.tutsplus.com/tutorials/developing-google-chrome-extensions--net-33076">Developing chrome extensions tutorial</a></li>
</ul>

<h3 id="bookmarklets">Bookmarklets</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/DloHqUfPbJc?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<p>Before I discuss chrome extensions, let’s briefly look at how bookmarklets work.  In JavaScript you can define a function like so:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">unicorn</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">unicorn!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>You can then execute that function like so:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">unicorn</span><span class="p">();</span></code></pre></figure>

<p>Functions in JavaScript, however, can be anonymous.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">unicorn!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>And if you put that whole anonymous function in parentheses and then add parentheses after it, it’s a “self-executing” function.  Meaning it’s called the moment it’s defined.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">unicorn!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})();</span></code></pre></figure>

<p>And that is what a bookmarklet is!  Here, try <a class="bookmarklet" href="javascript:(function() { alert('unicorn!');})();">dragging this one</a> to you bookmarks bar.</p>

<p>It’s the above javascript code inside an <code class="language-plaintext highlighter-rouge">a href</code> element with <code class="language-plaintext highlighter-rouge">javascript:</code> in front of the self-executable function.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:(function(){})()"</span><span class="nt">&gt;</span>bookmarklet<span class="nt">&lt;/a&gt;</span></code></pre></figure>

<p>If your code is complicated and long it’s often simpler to just put it in another JS file and reference it like so:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">script</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">http://shiffman.net/a2z/js/bookmarklet.js</span><span class="dl">'</span><span class="p">;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
<span class="p">})();</span></code></pre></figure>

<p>Now try this <a class="bookmarklet" href="javascript:(function(){var script = document.createElement('script');script.src = 'http://shiffman.net/a2z/js/bookmarklet.js?' + new Date().getTime();document.body.appendChild(script);})();">purpler</a> example which runs the following code (located at <a href="js/bookmarklet.js">http://shiffman.net/a2z/js/bookmarklet.js</a>) to turn all <code class="language-plaintext highlighter-rouge">&lt;p&gt;</code> elements pink.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">elts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">p</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">elts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">[</span><span class="dl">'</span><span class="s1">background-color</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#C0C</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})();</span></code></pre></figure>

<p>The advantage of this solution is that is also makes it possible to update the bookmarklet without user’s having to re-add it.  There is the problem of browser caching, however, which can usually be addressed with adding a random number or timestamp to the url.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">http://shiffman.net/a2z/js/bookmarklet.js</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">?</span><span class="dl">"</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span></code></pre></figure>

<p>(Note you can get fancier with the above if you want to cache hourly, daily, etc.)</p>

<h3 id="basics">Basics</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/9Tl3OmwrSaM?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<p>A chrome extension is a way of adding functionality to the chrome browser.  You can add interface elements, open and close tabs, interact with the address bar, as well as modify the contents of any page the browser is currently on.  The lovely thing for us is that extensions can be built with the same open web tools that we are already using – HTML, CSS, JavaScript.</p>

<p>All chrome extensions require a <code class="language-plaintext highlighter-rouge">manifest.json</code> file.  This file includes metadata about the extensions, sets its permissions, and references all the JavaScript, CSS, and other files associated with the extension.</p>

<p>Here is an example:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"manifest_version"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Extension"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.1"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>The <a href="https://developer.chrome.com/extensions/manifestVersion">manifest_version</a> should always be 2 as this is the current manifest specification.  <a href="https://developer.chrome.com/extensions/manifest">Here is the full spec</a> for manifest.json.</p>

<h3 id="content-scripts">Content Scripts</h3>

<p>The first thing you might try with an extension is making a content script.  A content script is a piece of JavaScript code (which can also include and reference CSS) that runs after the page loads.  It has full access to the DOM so you can do things like alter content, styles, layout, images, anything that is on the page.  The manifest.json file should reference your content script.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">manifest_version</span><span class="dl">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">My Extension</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">version</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.1</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">content_scripts</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">content.js</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<p>You also need to specify which URLs the content script should run on.  For example for all URLs, you would add:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="dl">"</span><span class="s2">content_scripts</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">matches</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">&lt;all_urls&gt;</span><span class="dl">"</span>
      <span class="p">],</span>
      <span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">content.js</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span></code></pre></figure>

<p>You can also specify individual unique URLs and using the wildcard <code class="language-plaintext highlighter-rouge">*</code> to encompass all paths on a given domain.  For example, the following would run the content script on any github.com page:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="dl">"</span><span class="s2">content_scripts</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">matches</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">http://github.com/*</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">https://github.com/*</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">http://*.github.com/*</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">https://*.github.com/*</span><span class="dl">"</span>
      <span class="p">],</span>
      <span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">content.js</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span></code></pre></figure>

<p>Let’s look at some very basic code that just takes every paragraph element and changes its background color to purple.  I’ll use native JavaScript below, but it is possible to use a DOM library like JQuery or p5.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">elts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">p</span><span class="dl">'</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">elts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">[</span><span class="dl">'</span><span class="s1">background-color</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#F0C</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>By default, Chrome runs the code in the content scripts after the DOM is completely loaded.  So there’s no need wrap the code inside a “ready” event.</p>

<p>This is all you need for a working chrome extension!  To test the extension, go to the browser’s extension page via <code class="language-plaintext highlighter-rouge">chrome://extensions/</code>.  Check “Developer mode” and then “Load unpacked extension”.  Browse to the directory where you’ve stored your <code class="language-plaintext highlighter-rouge">manifest.json</code> and <code class="language-plaintext highlighter-rouge">content.js</code> file.</p>

<p><img src="images/unpacked_extension.png" alt="unpacked" /></p>

<p>Once the extension is installed you can enable or disable it, as well as delete it.  Also note that if you change the code you’ll need to select “reload” before the new code will run.</p>

<h3 id="browser-actions">Browser Actions</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/ew9ut7ixIlI?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<p>User interface elements can be added as part of chrome extension via “browser” or “page” actions.  A browser action creates a button that lives on the top right of the browser.  A page action is an icon that appears in the address bar itself.</p>

<p>Browser and page actions can’t access the DOM itself, however, they can communicate with the content script via the chrome “messaging” API.  A browser action should have an icon (for the button) as well as a JavaScript file for the code.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="dl">"</span><span class="s2">browser_action</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">default_icon</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">icon.png</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">background</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">scripts</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">background.js</span><span class="dl">"</span><span class="p">],</span>
  <span class="p">}</span></code></pre></figure>

<p>When the user clicks the button, it triggers an “onClick” event.  This code would go in <code class="language-plaintext highlighter-rouge">background.js</code>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Add a listener for the browser action</span>
<span class="nx">chrome</span><span class="p">.</span><span class="nx">browserAction</span><span class="p">.</span><span class="nx">onClicked</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">buttonClicked</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">buttonClicked</span><span class="p">(</span><span class="nx">tab</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// The user clicked the button!</span>
  <span class="c1">// 'tab' is an object with information about the current open tab</span>
<span class="p">}</span></code></pre></figure>

<h3 id="messaging">Messaging</h3>

<p>Let’s say you want to execute some code in the content script (to manipulate the DOM) whenever the user triggers the browser action.  This is where you need to use “messaging”.  A message is just a JavaScript object of your own design that you send from the background script to the content script.  Here is the sending:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">buttonClicked</span><span class="p">(</span><span class="nx">tab</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">user clicked!</span><span class="dl">"</span>
  <span class="p">}</span>
  <span class="nx">chrome</span><span class="p">.</span><span class="nx">tabs</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>And then in the content script you can receive the message and perform an action.  Lots of data comes in with the message, but the actual object you sent is in the <code class="language-plaintext highlighter-rouge">request</code> variable.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Listen for messages</span>
<span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">onMessage</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">receiver</span><span class="p">);</span>

<span class="c1">// Callback for when a message is received</span>
<span class="kd">function</span> <span class="nx">receiver</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">sender</span><span class="p">,</span> <span class="nx">sendResponse</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">user clicked!</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Do something!</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<iframe width="312" height="175" src="https://www.youtube.com/embed/8zMMOdI5SOk?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>
<iframe width="312" height="175" src="https://www.youtube.com/embed/IXXNIcQQLU8?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<h3 id="pop-ups">Pop-ups</h3>

<iframe width="312" height="175" src="https://www.youtube.com/embed/YQnRSa8MGwM?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>
<iframe width="312" height="175" src="https://www.youtube.com/embed/kP-UmHrxCYk?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<p>The browser action can also trigger a pop-up, which is just an HTML page.  For example, you could run a p5 sketch in the pop-up as in <a href="../A2Z-F16/week10-chrome-ext/02_extension_browser_popup_p5">this example</a>.  To do this, reference the pop-up HTML file in <code class="language-plaintext highlighter-rouge">manifest.json</code>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="dl">"</span><span class="s2">browser_action</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">default_title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">you can also add a tool tip here</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">default_popup</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">popup.html</span><span class="dl">"</span>
<span class="p">}</span></code></pre></figure>

<p>The pop-up can also communicate with the content script via messaging.  There are two examples that demonstrate this functionality.  <a href="../A2Z-F16/week10-chrome-ext/03_extension_browser_popup_messaging">This first one</a> uses a slider and text field in the pop-up to alter the DOM content.  <a href="../A2Z-F16/week10-chrome-ext/04_extension_browser_popup_messaging_2">This second one</a> uses text that is selected on the page itself to make an API query.  Any JavaScript associated with the pop-up is not triggered unless the user clicks the button.  So in the second example, it’s worth noting that the message goes from the content script to the background script.  A pop-up can then access variables in the background script.  For example if the background script has a variable called <code class="language-plaintext highlighter-rouge">word</code>, you would say:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">word</span> <span class="o">=</span> <span class="nx">chrome</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">getBackgroundPage</span><span class="p">().</span><span class="nx">word</span><span class="p">;</span></code></pre></figure>

<iframe width="560" height="315" src="https://www.youtube.com/embed/GWDx1GnxhOw?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<h3 id="omnibox">Omnibox</h3>

<p>Actions can also be triggered by typing a keyword into the “omnibox” (also known as “address bar”).  The keyword is specified in <code class="language-plaintext highlighter-rouge">manifest.json</code>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="dl">"</span><span class="s2">omnibox</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">keyword</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">a2z</span><span class="dl">"</span>
  <span class="p">}</span></code></pre></figure>

<p>What to do after the user types a2z is handled in the background script.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// This event is fired when the user hits "enter"</span>
<span class="nx">chrome</span><span class="p">.</span><span class="nx">omnibox</span><span class="p">.</span><span class="nx">onInputEntered</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">omniChanged</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">omniChanged</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// The variable "text" has the text the user typed</span>
  <span class="c1">// You could open a new tab on a specific page that uses that text</span>
  <span class="c1">// or send a message to a content script</span>
  <span class="c1">// etc.</span>
<span class="p">}</span></code></pre></figure>

<h3 id="override-page">Override Page</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/vNb3P5KIxXw?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

<p>Chrome extensions allow you to replace the default chrome pages for bookmarks, history, and new tab. To replace new tab, for example, add the following to manifest.json.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="dl">"</span><span class="s2">chrome_url_overrides</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">newtab</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">newtab.html</span><span class="dl">"</span>
  <span class="p">}</span></code></pre></figure>

<p>Then you can create <code class="language-plaintext highlighter-rouge">newtab.html</code> with any HTML, CSS, or JavaScript. <a href="../A2Z-F16/week10-chrome-ext/08_override">Here’s an example that picks a random “word of the day” from Wordnik</a>.</p>

<h3 id="apis">APIs</h3>

<p>One of the benefits of using a chrome extension is <a href="https://developer.chrome.com/extensions/api_index">all of the APIs</a> that are available for controlling the behavior of the browser.  Some that might interest you are:</p>

<ul>
  <li><a href="https://developer.chrome.com/extensions/alarms">Alarms API</a></li>
  <li><a href="https://developer.chrome.com/extensions/tabs">tabs</a> and <a href="https://developer.chrome.com/extensions/windows">windows</a></li>
  <li><a href="https://developer.chrome.com/extensions/tts">tts (text-to-speech)</a></li>
  <li><a href="https://developer.chrome.com/extensions/webRequest">webRequest</a></li>
</ul>

<iframe width="560" height="315" src="https://www.youtube.com/embed/RJtjp-Vtwjs?list=PLRqwX-V7Uu6bL9VOMT65ahNEri9uqLWfS" frameborder="0" allowfullscreen=""></iframe>

  </div>
</section>
<button class="mobile-quick-links" aria-controls="quicklinks-section" aria-haspopup="true" id="quicklinks-btn">VIEW QUICK LINKS</button>
<aside class="right-container quick-links out" id="quicklinks-section">
  <div class="quick-link">
    <a href="index.html" class="secondary">About the course</a>
  </div>
  <h3>Tutorials</h3>
  <div class="quick-link">
    <a href="intro.html" class="secondary">Introduction - p5.js, JavaScript, and Strings</a>
  </div>
  <div class="quick-link">
    <a href="regex.html" class="secondary">Regular Expressions</a>
  </div>
  <div class="quick-link">
    <a href="closures.html" class="secondary">Closures</a>
  </div>
  <div class="quick-link">
    <a href="data-apis.html" class="secondary">Libraries, Data, and APIs</a>
  </div>
  <div class="quick-link">
    <a href="server-node.html" class="secondary">Server-side programming with node.js</a>
  </div>
  <div class="quick-link">
    <a href="twitter-bots.html" class="secondary">Twitter API and bots with node.js</a>
  </div>
  <div class="quick-link">
    <a href="bot-ec2.html" class="secondary">Deploy Bot to Amazon EC2</a>
  </div>
  <div class="quick-link">
    <a href="bot-heroku.html" class="secondary">Deploy Bot to Heroku</a>
  </div>
  <div class="quick-link">
    <a href="text-analysis.html" class="secondary">Text Analysis</a>
  </div>
  <div class="quick-link">
    <a href="markov.html" class="secondary">N-Grams and Markov Chains</a>
  </div>
  <div class="quick-link">
    <a href="cfg.html" class="secondary">Context-Free Grammar</a>
  </div>
  <div class="quick-link">
    <a href="node-api.html" class="secondary">Creating an API in Node</a>
  </div>
  <div class="quick-link">
    <a href="firebase.html" class="secondary">Database as Service: Firebase</a>
  </div>
  <div class="quick-link">
    <a href="chrome-ext.html" class="secondary">Chrome Extensions</a>
  </div>
</aside>


    <footer class="left-container about out">
    <div class="content-wrapper article">
        <p>Source code for this website can be found on <a href="https://github.com/shiffman/shiffman.net/" target="_blank">Github</a>.</p>
    </div>
</footer>


<script>

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-94163-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
