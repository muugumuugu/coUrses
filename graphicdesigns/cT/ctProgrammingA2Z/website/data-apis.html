<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Data, Libraries, and APIs | Daniel Shiffman</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    
    
    <script src="js/jquery.js"></script>
    <script src="js/main.js"></script>
    
</head>


  <body>

    


      <link rel="stylesheet" type="text/css" href="css/prism.css">
<link rel="stylesheet" type="text/css" href="css/highlight.css">
<link rel="stylesheet" type="text/css" href="css/a2z.css">
<script src="js/blog.js"></script>
<script src="js/prism.js"></script>

<section class="left-container out a2z">
  <h1>Programming from A to Z</h1>
  <p><br/>

    <a href="index.html" class="body-link primary">about</a> 
    <a href="../A2Z-F16/README.md" class="body-link primary">syllabus</a>
    <a href="../A2Z-F16" class="body-link primary">All example source code</a>

  </p>
  <span class="line-charm first"></span>
  <div class="content-wrapper article a2z">
    <h2 id="data-libraries-and-apis">Data, Libraries and APIs</h2>

<h3 id="simple-json">Simple JSON</h3>
<ul>
  <li><a href="../A2Z-F17/week3-apis-data/00_corpora/">JSON from Corpora</a>, <a href="../A2Z-F17/week3-apis-data/00_corpora">source</a></li>
</ul>

<h3 id="javascript-language-processing-libraries">JavaScript Language Processing Libraries</h3>
<ul>
  <li><a href="../A2Z-F17/week3-apis-data/01_rita_demo/">RiTa.js Demo</a>, <a href="../A2Z-F17/week3-apis-data/01_rita_demo">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/02_nlp_compromise/">NLP Compromise Demo</a>, <a href="../A2Z-F17/week3-apis-data/02_nlp_compromise">source</a></li>
</ul>

<h3 id="api-examples">API examples</h3>
<ul>
  <li><a href="../A2Z-F17/week3-apis-data/03_wordnik_randomwords/">Wordnik – get random words</a>, <a href="../A2Z-F17/week3-apis-data/03_wordnik_randomwords">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/04_wordnik_word_info/">Wordnik – word info</a>, <a href="../A2Z-F17/week3-apis-data/04_wordnik_word_info">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/05_wordnik_related/">Wordnik – related words</a>, <a href="../A2Z-F17/week3-apis-data/05_wordnik_related">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/06_nytimes_articles/">NYTimes API article search</a>, <a href="../A2Z-F17/week3-apis-data/06_nytimes_articles">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/07_wikipedia/">Wikipedia API article search</a>, <a href="../A2Z-F17/week3-apis-data/07_wikipedia">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/08_nytimes_word_counts/">NYTimes word counts – many API calls</a>, <a href="../A2Z-F17/week3-apis-data/08_nytimes_word_counts">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/09_google_sheets/">Google Sheets with tabletop.js</a>, <a href="../A2Z-F17/week3-apis-data/09_google_sheets">source</a></li>
  <li><a href="../A2Z-F17/week3-apis-data/10_google_sheets_madlibs/">MadLibs with Google Sheets</a>, <a href="../A2Z-F17/week3-apis-data/10_google_sheets_madlibs">source</a></li>
</ul>

<h3 id="ritajs">RiTaJS</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/lIPEvh8HbGQ?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>When I think of programming libraries and frameworks for text-based data I think of python and libraries like the <a href="http://www.nltk.org/">Nature Language Toolkit (NLTK)</a>.  However, there are still lots of options for language and text-based code libraries for JavaScript.  I’ll look at two on this page starting with RiTaJS.  <a href="https://github.com/dhowe/RiTaJS">RiTaJS</a> is the JavaScript implementation of <a href="http://rednoise.org/rita/">RiTa</a> by Daniel Howe.</p>

<blockquote>Designed to support the creation of new works of computational literature, the RiTa library provides tools for artists and writers working with natural language in programmable media.</blockquote>

<p>The RiTa library has numerous features around text analysis and generation.  For example, it has features built into it to generate text with algorithms and systems (Markov Chains, Context Free Grammer) I’ll cover in later tutorials.</p>

<p>To use RiTa, you can grab the JavaScript library files from the <a href="http://rednoise.org/rita/download.php">RiTa download page</a>.  For my examples, I’m using the RiTa Lexicon which requires <code class="language-plaintext highlighter-rouge">rita-full.js</code>.</p>

<p>For now I want to look at two features, the <code class="language-plaintext highlighter-rouge">RiString</code> object and the <code class="language-plaintext highlighter-rouge">RiLexicon</code> object.  <code class="language-plaintext highlighter-rouge">RiString</code> allows you to analyze a piece of text.  You can tokenize it, count syllables, determine parts of speech, etc.  One particularly useful function is <code class="language-plaintext highlighter-rouge">features()</code> which returns an object with features for the sentence, including phonemes, syllables, stresses, etc.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">It was a dark and stormy night.</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">rs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RiString</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
<span class="c1">// Look at the "features" of a string.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rs</span><span class="p">.</span><span class="nx">features</span><span class="p">());</span></code></pre></figure>

<p><img src="images/ristring.png" alt="rita1" /></p>

<p>It should be noted that the parts of speech tags are from the <a href="https://www.ling.upenn.edu/courses/Fall_2003/ling001/penn_treebank_pos.html">Penn Treebank Project</a>.</p>

<p>RiTaJS also has a lexicon built into it.  A lexicon is another word for “vocabulary” and operates like a machine readable dictionary.  <a href="http://rednoise.org/rita/reference/RiLexicon.php">The RiTa lexicon</a> contains about 40,000 words along with associated spelling and phonemic data.  The library provides many hooks into the lexicon.  For example, you can ask it for random words of a given part of speech or with a certain syllable account.  It also can provide words that rhyming words and words that “sound similar.” To use the lexicon, you simply need to make a <code class="language-plaintext highlighter-rouge">RiLexicon</code> object.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">lexicon</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RiLexicon</span><span class="p">();</span></code></pre></figure>

<p>Once you have the object you can query it anywhere in your code.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Random noun</span>
<span class="nx">lexicon</span><span class="p">.</span><span class="nx">randomWord</span><span class="p">(</span><span class="dl">'</span><span class="s1">nn</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// List of words that rhyme with cat</span>
<span class="nx">lexicon</span><span class="p">.</span><span class="nx">rhymes</span><span class="p">(</span><span class="dl">'</span><span class="s1">cat</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Alliterations</span>
<span class="nx">lexicon</span><span class="p">.</span><span class="nx">alliterations</span><span class="p">(</span><span class="dl">'</span><span class="s1">cat</span><span class="dl">'</span><span class="p">);</span></code></pre></figure>

<p>You can also customize the lexicon by editing the JS library files themselves or programmatically with <a href="http://rednoise.org/rita/reference/RiLexicon/addWord/index.php"><code class="language-plaintext highlighter-rouge">addWord()</code></a> and <a href="https://shiffman.net/a2z/data-apis/(http://rednoise.org/rita/reference/RiLexicon/removeWord/index.php)"><code class="language-plaintext highlighter-rouge">removeWord</code></a>.</p>

<h3 id="nlp-compromise">NLP-Compromise</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/tk_JGu2AbJY?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>Another useful natural language processing library in JavaScript is <a href="http://nlp-compromise.github.io/website/">NLP-Compromise</a>, source on <a href="https://github.com/nlp-compromise/nlp_compromise">github</a> by <a href="https://s3.amazonaws.com/spencermounta.in/index.html">Spencer Kelly</a>.</p>

<p>Just like with RiTaJS you can download the library files to use with your sketch.  However, most JavaScript libraries are also available via a “CDN” (Content Delivery Network) meaning you can reference them on a web server directly in <code class="language-plaintext highlighter-rouge">index.html</code>.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://unpkg.com/nlp_compromise@latest/builds/nlp_compromise.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>Once the library is loaded you can create a variable to call of its functions on.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">nlp</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">nlp_compromise</span><span class="p">;</span></code></pre></figure>

<p>NLP-Compromise works by allowing you to chain together a series of functions that build and/or adjust a block of text.  For example, if you want to work with a noun you would say:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">noun</span> <span class="o">=</span> <span class="nx">nlp</span><span class="p">.</span><span class="nx">noun</span><span class="p">(</span><span class="dl">'</span><span class="s1">cat</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">noun</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">());</span> <span class="c1">// cats</span></code></pre></figure>

<p>But typically you’ll see these actions chained together:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">cats</span> <span class="o">=</span> <span class="nx">nlp</span><span class="p">.</span><span class="nx">noun</span><span class="p">(</span><span class="dl">'</span><span class="s1">cat</span><span class="dl">'</span><span class="p">).</span><span class="nx">pluralize</span><span class="p">());</span></code></pre></figure>

<p>NLP-Compromise can negate statements, conjugate verbs (and therby alter tense), provide articles and pronouns, and more.</p>

<h3 id="data">Data</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/rJaXOFfwGVw?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>Some parts of this page is excerpted (and adapted for JavaScript) from <a href="http://learningprocessing.com">Learning Processing</a>.</p>

<p>Data can come from many different places: websites, news feeds, spreadsheets, databases, and so on. Let's say you've decided to make a map of the world's flowers. After searching online you might find a PDF version of a flower encyclopedia, or a spreadsheet of flower genera, or a JSON feed of flower data, or a REST API that provides geolocated lat/lon coordinates, or some web page someone put together with beautiful flower photos, and so on and so forth. The question inevitably arises: “I found all this data; which should I use, and how do I get it?”</p>

<p>If you are really lucky, you might find a JavaScript library that hands data to you directly with code. Maybe the answer is to just download this library and write some code like:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">fdb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FlowerDatabase</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">sunflower</span> <span class="o">=</span> <span class="nx">fdb</span><span class="p">.</span><span class="nx">findFlower</span><span class="p">(</span><span class="dl">"</span><span class="s2">sunflower</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">sunflower</span><span class="p">.</span><span class="nx">getAverageHeight</span><span class="p">();</span>
<span class="p">}</span>  </code></pre></figure>

<p>In this case, someone else has done all the work for you. They've gathered data about flowers and built a library with a set of functions that hands you the data in an easy-to-understand format. This library, sadly, does not exist (not yet), but there are some that do.</p>

<p>Let's take another scenario. Say you’re looking to build a visualization of Major League Baseball statistics. You can't find a library to give you the data but you do see everything you’re looking for at mlb.com. If the data is online and your web browser can show it, shouldn't you be able to get the data? Passing data from one application (like a web application) to another is something that comes up again and again in software engineering. A means for doing this is an API or “application programming interface”: a means by which two computer programs can talk to each other. Now that you know this, you might decide to search online for “MLB API”. Unfortunately, mlb.com does not provide its data via an API. In this case you would have to load the raw source of the website itself and manually search for the data you’re looking for. While possible, this solution is much less desirable given the considerable time required to read through the HTML source as well as program algorithms for parsing it.</p>

<p>The goal of these notes is to give you an overview of techniques, ranging from the more difficult manual parsing of data, to the parsing of standardized formats, to the use of an API designed specifically for JavaScript itself. Each means of getting data comes with its own set of challenges. The ease of using a JavaScript library is dependent on the existence of clear documentation and examples. But in just about all cases, if you can find your data in a format designed for a computer (spreadsheets, XML, JSON, etc.), you'll be able to save some time in the day for a nice walk outside.</p>

<h1>JSON</h1>

<iframe width="312" height="175" src="https://www.youtube.com/embed/_NFkzw6oFtQ?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>
<iframe width="312" height="175" src="https://www.youtube.com/embed/118sDpLOClw?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>The data exchange format that all of this week's examples focus on is called  JSON (pronounced like the name Jason), which stands for JavaScript Object Notation. Its design was based on the syntax for objects in the JavaScript programming language (and is most commonly used to pass data between web applications) but has become rather ubiquitous and language-agnostic.  Working with it in JavaScript is incredibly convenient.</p>

<p>All JSON data comes in the following two ways: an object or an array.  And the syntax for these is identical to the syntax you see in JavaScript itself.</p>

<p>Let's take a look at a JSON object first. A JSON object is identical to a JavaScript object (without functions). It’s a collection of variables with a name and a value (or "name/value pair").  Each name is encoded as a string enclosed in quotes, this is just about the only difference.  For example, following is JSON data describing a person:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Olympia</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">:</span><span class="mf">96.5</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">state</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">giggling</span><span class="dl">"</span>
<span class="p">}</span></code></pre></figure>

<p>This is how it might look if you typed it into your code directly (the quotes are no longer necessary.)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Olympia</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">age</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">height</span><span class="p">:</span> <span class="mf">96.5</span><span class="p">,</span>
  <span class="na">state</span><span class="p">:</span> <span class="dl">"</span><span class="s2">giggling</span><span class="dl">"</span>
<span class="p">}</span></code></pre></figure>

<p>An object can contain, as part of itself, another object.  Below, the value of “brother” is an object containing two name/value pairs.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Olympia</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">height</span><span class="dl">"</span><span class="p">:</span><span class="mf">96.5</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">state</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">giggling</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">brother</span><span class="dl">"</span><span class="p">:{</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Elias</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span><span class="mi">6</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>To compare to data format like XML, the preceding JSON data would look like the following (for simplicity I'm avoiding the use of XML attributes).</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;xml</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">encoding=</span><span class="s">"UTF-8"</span><span class="err">?</span><span class="nt">&gt;</span>
<span class="nt">&lt;person&gt;</span>
  <span class="nt">&lt;name&gt;</span>Olympia<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;age&gt;</span>3<span class="nt">&lt;/age&gt;</span>
  <span class="nt">&lt;height&gt;</span>96.5<span class="nt">&lt;/height&gt;</span>
  <span class="nt">&lt;state&gt;</span>giggling<span class="nt">&lt;/state&gt;</span>
  <span class="nt">&lt;brother&gt;</span>
    <span class="nt">&lt;name&gt;</span>Elias<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;age&gt;</span>6<span class="nt">&lt;/age&gt;</span>
  <span class="nt">&lt;/brother&gt;</span>
<span class="nt">&lt;/person&gt;</span></code></pre></figure>

<p>Multiple JSON objects can appear in the data as an array. A JSON array is simply a list of values (primitives or objects). The syntax is identical to JavaScript syntax. Here is a simple JSON array of integers:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span></code></pre></figure>

<p>You might find an array as part of an object. Below the value of “favorite colors” is an array of strings.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Olympia</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">favorite colors</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">purple</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">blue</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">pink</span><span class="dl">"</span><span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<p>A great place to find a selection of JSON data sources to play with is <a href="https://github.com/dariusk/corpora">corpora</a>, a github repository maintained by <a href="http://tinysubversions.com/">Darius Kazemi</a>.  For example, here’s <a href="https://github.com/dariusk/corpora/blob/master/data/animals/birds_antarctica.json">a JSON file containing information about birds in Antarctica</a>.</p>

<h3 id="loading-json-into-your-code">Loading JSON into your code</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/6mT3r8Qn1VY?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>Now that I've covered the syntax of JSON, I can look at using the data in JavaScript and p5.js.  The first step is simply loading the data <code>loadJSON()</code>. <code>loadJSON()</code> can be called in <code>preload</code> or used with a callback.  I'm using callbacks in just about all my examples so let's follow that syntax here.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">loadJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">birds_antarctica.json</span><span class="dl">'</span><span class="p">,</span> <span class="nx">gotData</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">gotData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// The JSON is now in data!</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>The data from the JSON file is passed into the argument <code>data</code> in the <code>gotData</code> callback.  Then it becomes a bit of detective work.  How is the data structured — a single object? an array of objects?  An object full of arrays of objects?  Let’s look at a snippet from the birds of Antarctica.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Birds of Antarctica, grouped by family</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">source</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://en.wikipedia.org/wiki/List_of_birds_of_Antarctica</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">birds</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">family</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Albatrosses</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">Wandering albatross</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">Sooty albatross</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">Light-mantled albatross</span><span class="dl">"</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">family</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Cormorants</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">Antarctic shag</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">Imperial shag</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">Crozet shag</span><span class="dl">"</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<p>If the JSON file is loaded into the variable <code>data</code>, the way you access that data is no different than if you had said:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Birds of Antarctica, grouped by family</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">source</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://en.wikipedia.org/wiki/List_of_birds_of_Antarctica</span><span class="dl">"</span>
  <span class="c1">// etc</span>
<span class="p">}</span></code></pre></figure>

<p>For example, if you wanted to display the description and link it to the source you would say:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">createA</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">source</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">description</span><span class="p">);</span></code></pre></figure>

<p>And since <code>birds</code> is an array of objects, you can use a <code>for</code> loop just the way you always do with arrays.  Each element of the array is an object itself with properties that can be accessed like <code>family</code> and <code>members</code> (which is also an array!).</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">birds</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">family</span>  <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">birds</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">family</span><span class="p">;</span>
  <span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">h2</span><span class="dl">'</span><span class="p">,</span> <span class="nx">family</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">members</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">birds</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">members</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">members</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createDiv</span><span class="p">(</span><span class="nx">members</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Here’s what this looks like:</p>

<div style="padding:24px;background-color:#f8f8f8;margin-bottom:24px">
<p><a href="https://en.wikipedia.org/wiki/List_of_birds_of_Antarctica">Birds of Antarctica, grouped by family</a></p>
<h2>Albatrosses</h2>
<div>Wandering albatross</div>
<div>Sooty albatross</div>
<div>Light-mantled albatross</div>
<p></p>
<h2>Cormorants</h2>
<div>Antarctic shag</div>
<div>Imperial shag</div>
<div>Crozet shag</div>
</div>

<h3 id="apis">APIs</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/ecT42O6I_WI?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<p>What makes something an API versus just some data you found, and what are some pitfalls you might run into when using an API?</p>

<p>An API (Application Programming Interface) is an interface through which one application can access the services of another. These can come in many forms. <a href="http://openweathermap.org/">Openweathermap.org</a> is an API that offers its data in JSON, XML, and HTML formats. The key element that makes this service an API is exactly that offer; openweathermap.org's sole purpose in life is to offer you its data. And not just offer it, but allow you to query it for specific data in a specific format. Let's look at a short list of sample queries.</p>

<ol>
  <li><a href="http://api.openweathermap.org/data/2.5/weather?lat=35&amp;lon=139">http://api.openweathermap.org/data/2.5/weather?lat=35&amp;lon=139</a><em><br />(A request for current weather data for a specific latitude and longitude)</em></li>
  <li><a href="http://api.openweathermap.org/data/2.5/forecast/daily?q=London&amp;mode=xml&amp;units=metric&amp;cnt=7&amp;lang=zh_cn">http://api.openweathermap.org/data/2.5/forecast/daily?q=London&amp;mode=xml&amp;units=metric&amp;cnt=7&amp;lang=zh_cn</a><br /><em>(A request for a seven day London forecast in XML format with metric units and in Chinese.)</em></li>
  <li><a href="http://api.openweathermap.org/data/2.5/history/station?id=5091&amp;type=day">http://api.openweathermap.org/data/2.5/history/station?id=5091&amp;type=day</a><br /><em>(A request for a historical data for a given weather station.)</em></li>
</ol>

<p>One thing to note about openweathermap.org is that it does not require that you tell the API any information about yourself. You simply send a request to a URL and get the data back. Other APIs, however, require you to sign up and obtain an access token. <em>The New York Times</em> API is one such example. Before you can make a request, you'll need to visit <a href="http://developer.nytimes.com/"><em>The New York Times</em> Developer site</a> and request an API key. Once you have that key, you can store it in your code as a string.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// This is not a real key</span>
<span class="kd">var</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">40e2es0b3ca44563f9c62aeded4431dc:12:51913116</span><span class="dl">"</span><span class="p">;</span></code></pre></figure>

<p>You also need to know what the URL is for the API itself. This information is documented for you on the developer site, but here it is for simplicity:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://api.nytimes.com/svc/search/v2/articlesearch.json</span><span class="dl">"</span><span class="p">;</span></code></pre></figure>

<p>Finally, you have to tell the API what it is you are looking for. This is done with a “query string,” a sequence of name value pairs describing the parameters of the query joined with an ampersand. This functions similarly to how you pass arguments to a function. If you wanted to search for the term "JavaScript" from a <code>search()</code> function you might say:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">search</span><span class="p">(</span><span class="dl">"</span><span class="s2">JavaScript</span><span class="dl">"</span><span class="p">);</span></code></pre></figure>

<p>Here, the API acts as the function call, and you send it the arguments via the query string. Here is a simple example asking for a list of the oldest articles that contain the term "JavaScript" (the oldest of which turns out to be May 12th, 1852).</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// The name/value pairs that configure the API query are: (q,JavaScript) and (sort,oldest)</span>
<span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">?q=JavaScript&amp;sort=oldest</span><span class="dl">"</span><span class="p">;</span></code></pre></figure>

<p>This isn't just guesswork. Figuring out how to put together a query string requires reading through the API's documentation. For <em>The New York Times</em>, it’s all outlined on <a href="http://developer.nytimes.com/docs/read/article_search_api_v2">the <em>Times'</em> developer website</a>. Once you have your query you can join all the pieces together and pass it to <code>loadJSON()</code>. Here is a tiny example that simply displays the most recent headline.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">sample-key</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://api.nytimes.com/svc/search/v2/articlesearch.json</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">?q=JavaScript&amp;sort=newest</span><span class="dl">"</span><span class="p">;</span>

  <span class="c1">// Here, I format the call to the API by joing the URL with the API key with the query string.</span>
  <span class="nx">loadJSON</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="nx">query</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;api-key=</span><span class="dl">"</span><span class="o">+</span><span class="nx">apiKey</span><span class="p">,</span> <span class="nx">gotData</span><span class="p">);</span>

  <span class="kd">function</span> <span class="nx">gotData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Grabbing a single headline from the results.</span>
    <span class="kd">var</span> <span class="nx">headline</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">headline</span><span class="p">.</span><span class="nx">main</span><span class="p">;</span>
    <span class="nx">createP</span><span class="p">(</span><span class="nx">headline</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Some APIs require a deeper level of authentication beyond an API access key. Twitter, for example, uses an authentication protocol known as “OAuth” to provide access to its data. Writing an OAuth application requires more than just passing a string into a request.  There are some examples this week that use server-side programming in Node to perform the authentication.</p>

<iframe width="312" height="175" src="https://www.youtube.com/embed/4UoUqnjUC2c?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>
<iframe width="312" height="175" src="https://www.youtube.com/embed/UNtqhnhD-wo?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<h3 id="encoding-urls">Encoding URLs</h3>

<p>Certain characters and invalid in URLs.  For example, let’s say you were querying wordnik for the words “bath towel”.  You would have to say <code>bath%20towel</code>.  You could do this yourself with a regex or use URI encoding with <code>encodeURI()</code>.  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI">Here is more documentation</a> and an example below.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">http://api.wordnik.com/v4/word.json/bath towel/api_key=apikeyblahblahblah</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// Encode the query before you ask for it</span>
<span class="kd">var</span> <span class="nx">encoded</span> <span class="o">=</span> <span class="nb">encodeURI</span><span class="p">(</span><span class="nx">query</span><span class="p">);</span>
<span class="nx">loadJSON</span><span class="p">(</span><span class="nx">encoded</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span></code></pre></figure>

<p><code>encodeURI</code> does not encode the following characters: <code>, / ? : @ &amp; = + $ #</code>. This is as it should be since these are used in URLs to mean certain things.  However, if you wanted to have a $ or / as part of some text you are passing into a key/value pair you <em>would</em> want to encode these characters.  For this <code>encodeURIcomponent()</code> can be used.</p>

<h3 id="wordnik-api">Wordnik API</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/YsgdUaOrFnQ?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<h3 id="nytimes-api">NYTimes API</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/IMne3LY4bks?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

<h3 id="wikipedia-api">Wikipedia API</h3>

<p>Coming soon.</p>

<h3 id="google-sheets">Google sheets</h3>

<iframe width="525" height="300" src="https://www.youtube.com/embed/ziBO-U2_t3k?list=PLRqwX-V7Uu6a-SQiI4RtIwuOrLJGnel0r" frameborder="0" allowfullscreen=""></iframe>

  </div>
</section>
<button class="mobile-quick-links" aria-controls="quicklinks-section" aria-haspopup="true" id="quicklinks-btn">VIEW QUICK LINKS</button>
<aside class="right-container quick-links out" id="quicklinks-section">
  <div class="quick-link">
    <a href="index.html" class="secondary">About the course</a>
  </div>
  <h3>Tutorials</h3>
  <div class="quick-link">
    <a href="intro.html" class="secondary">Introduction - p5.js, JavaScript, and Strings</a>
  </div>
  <div class="quick-link">
    <a href="regex.html" class="secondary">Regular Expressions</a>
  </div>
  <div class="quick-link">
    <a href="closures.html" class="secondary">Closures</a>
  </div>
  <div class="quick-link">
    <a href="data-apis.html" class="secondary">Libraries, Data, and APIs</a>
  </div>
  <div class="quick-link">
    <a href="server-node.html" class="secondary">Server-side programming with node.js</a>
  </div>
  <div class="quick-link">
    <a href="twitter-bots.html" class="secondary">Twitter API and bots with node.js</a>
  </div>
  <div class="quick-link">
    <a href="bot-ec2.html" class="secondary">Deploy Bot to Amazon EC2</a>
  </div>
  <div class="quick-link">
    <a href="bot-heroku.html" class="secondary">Deploy Bot to Heroku</a>
  </div>
  <div class="quick-link">
    <a href="text-analysis.html" class="secondary">Text Analysis</a>
  </div>
  <div class="quick-link">
    <a href="markov.html" class="secondary">N-Grams and Markov Chains</a>
  </div>
  <div class="quick-link">
    <a href="cfg.html" class="secondary">Context-Free Grammar</a>
  </div>
  <div class="quick-link">
    <a href="node-api.html" class="secondary">Creating an API in Node</a>
  </div>
  <div class="quick-link">
    <a href="firebase.html" class="secondary">Database as Service: Firebase</a>
  </div>
  <div class="quick-link">
    <a href="chrome-ext.html" class="secondary">Chrome Extensions</a>
  </div>
</aside>


    <footer class="left-container about out">
    <div class="content-wrapper article">
        <p>Source code for this website can be found on <a href="https://github.com/shiffman/shiffman.net/" target="_blank">Github</a>.</p>
    </div>
</footer>


<script>

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-94163-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
