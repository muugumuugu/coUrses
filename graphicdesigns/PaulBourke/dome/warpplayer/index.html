<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>warpplayer: QuickTime movie player with realtime warping and navigation</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800><tr><td>

<center>
<h1>warpplayer: QuickTime movie player<br>with realtime warping and navigation</h1>
<b>Intended primarily for <a href="../../papers/planetarian1/index.html">
fulldome projection using a spherical mirror</a></b><p>
<b>Also used as a <a href="../../papers/auc2007/index.html">navigable movie player</a></b><p>
Written by Paul Bourke, Ian Hooper, Evan Hallein<br>
Documentation by <a href="../index.html">Paul Bourke</a><p>
</center>
<p><br><p>

<center><table width=600><tr><Td>
<p align="justify">
<b>
As of the end of 2019, VLCwarp is no longer supported for MacOSX. While it still works on older versions of MacOS, such as High Sierra and Mojave, it does not work as advertised on newer version of MacOS. 
Readers are strongly encouraged to consider the newer 
</b>
<a href="../fishwarp/index.html"><b>Fisheye Movie Player for Spherical Mirror Projection</a>.
</b>
</p>
</td></tr></table></center><p>
<br><p>

<p align="justify">
Trial version :
<a href="http://paulbourke.net/dome/warpplayer/WarpPlayer_demo_95.zip">WarpPlayer_demo_95.zip</a>.
Please check the demo version with your hardware/OS before buying.
Quick instructions: <a href="http://paulbourke.net/dome/warpplayer/instructions.jpg">Screen shot</a>. Rename the .data file
with the same aspect ratio as your projector to "default.data", this is the warping
that will applied by warpplayer. Drag/drop a QuickTime movie onto the player.
</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="CKGTWXYKRJMFG">
<input type="image" src="https://www.paypalobjects.com/en_AU/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal â€” The safer, easier way to pay online.">
<img alt="" border="0" src="https://www.paypalobjects.com/en_AU/i/scr/pixel.gif" width="1" height="1">
</form>
</center>

<p><br><p>

<b>Introduction</b>

<p align="justify">
"warpplayer" is a Mac OS-X application that takes a QuickTime movie and a description
of how to distort each frame. The movie is played and distorted on the fly. There are
many applications for this and some of them will be discussed below, the main reason for
developing this was for movie playback in fulldome (eg: planetarium environments) where
a <a href="../index.html">spherical mirror</a> is used to distort the fisheye frames
of the movie. 
</p>

<p align="justify">
In addition to the realtime warping, the application allows navigation while
the movie is playing. The exact navigation that is appropriate depends on the input
image projection, for example, for a fisheye image the movie can be rotated about the
pole while it is playing. For a movie where each frame is a cylindrical projection the view
direction can be rotated horizontally during playback.
</p>

<b>Update 2019</b>
<p align="justify">
Due to changes in High Sierra and Mojave, the automatic reading of "default.data" no longer seems
to be working. Until a fix for this is found, it is necessary to set the location of the warp mesh
file explicitely in the preferences. Noting that the whole path to the file is required. So, if the warp
file is called "default.data", if the user account name is "Domeuser", and the warp file is located
in the users home directory, then the path to the file would be (noting that it is case sensitive)
</p>
<center>
   /Users/Domeuser/default.data
</center>
<p>
<center>
   <A href="http://paulbourke.net/dome/warpplayer/path.png">
   <img src="http://paulbourke.net/dome/warpplayer/path.png" width=600 height=514 border=1></a>
</center>

<b>Example</b>

<p align="justify">
The following example is targeted at fisheye movies, the original frame is taken from
"Moonlight" by Andrew Quinn. A sample frame is shown below along with various mappings.
The power of this approach is immediately obvious, namely that one movie can be
shown in multiple environments without being preprocessed for each. Note the grid lines are
turned on in order to illustrate the nature of the texture mapping. For all practical purposes 
any image distortion can be achieved, it only requires that someone can create the correct
warp map file.
</p>
<center><table width=100%>
<tr>
<td valign="bottom">
	<center>
	<a href="http://paulbourke.net/dome/warpplayer/fish1.jpg"><img src="http://paulbourke.net/dome/warpplayer/fish1s.jpg" width=380 height=380 border=1></a><br>
	Single frame from the fisheye movie.
	</center>
</td>
<td valign="bottom">
	<center>
	<a href="http://paulbourke.net/dome/warpplayer/fish2.jpg"><img src="http://paulbourke.net/dome/warpplayer/fish2s.jpg" width=380 height=285 border=1></a><br>
	Truncated fisheye as used by many fisheye projector systems.
	</center>
</td>
</tr>
</table></center><p>
<table width=100%>
<tr>
<td valign="bottom">
	<center>
	<a href="http://paulbourke.net/dome/warpplayer/fish3.jpg"><img src="http://paulbourke.net/dome/warpplayer/fish3s.jpg" width=333 height=250 border=1></a><br>
	Warped image for spherical mirror projection, 4x3.
	</center>
</td>
<td valign="bottom">
	<center>
	<a href="http://paulbourke.net/dome/warpplayer/fish4.jpg"><img src="http://paulbourke.net/dome/warpplayer/fish4s.jpg" width=450 height=250 border=1></a><br>
	Warped image for spherical mirror projection, 16x9.
	</center>
</td>
</tr>
</table></center><p>

<b>Mesh data file structure</b>

<p align="justify">
The data file that describes the warping is simply a description of a regular mesh
with texture coordinates. The format is as follows: the file is a plain (human readable)
text file, the first
line contains a single digit that indicates the input image format
the mesh is assumed to apply to, the second line gives the dimensions of the mesh, the
subsequent lines contain 5 numbers per line that describe each node of the mesh. These lines
consist of x and y (the coordinate of the mesh in normalised screen coordinates), the u and v
texture coordinate of that node (range from 0 to 1), and finally a multiplicative intensity
value. Normalised screen coordinates range from -aspect to aspect ratio in the horizontal
axis and -1 to 1 in the vertical axis.
</p>
Input image projections supported are given below,
the next release will additionally support stereoscopic versions of each of the above.<br>
<ul>
<li>1: planar image, perspective projection<br>
<li>2: fisheye projection<br>
<li>3: cylindrical projection<br>
<li>4: spherical projection<br>
<li>5: cubic map<br>
</ul>

<p align="justify">
Please contact the author for further details on these mesh files and how they might be
created for your own distortion requirements. Two mesh files are given here as examples:
<a href="http://paulbourke.net/dome/warpplayer/rect.data.zip">rect.data.zip</a> doesn't perform any distortion, for a 4:3 movie
it plays it back unmodified; <a href="http://paulbourke.net/dome/warpplayer/warpfish.data.zip">warpfish.data.zip</a> warps
a fisheye movie for spherical mirror projection (at least for a particular configuration and
4:3 aspect ratio projector).
</p>

<b>Input image types</b>
<p align="justify">
While the exact form of the projection of the input image and the form of the warping is
very general, there are some input and output image projections explicitly supported (tested) and for
which example mesh files can be provided. Note also that the exact form of navigation
is dependent on the input image projection for example, it doesn't make sense (at least in 
a hemispherical dome environment) to zoom in on a fisheye image, and only horizontal rotation
makes sense for cylindrical projections.
</p>

<center>
<table border=1 cellspacing=0 cellpadding=5>

<tr>
<td bgcolor="#cccccc">Input image projection</td>
<td  bgcolor="#cccccc" colspan=5><center>Output image projection</center></td>
<td bgcolor="#cccccc">Navigation</td>
</tr>

<tr>
<td bgcolor="#cccccc">Fisheye</td>
<td>Fisheye</td>
<td>Truncated fisheye</td>
<td>Warped fisheye</td>
<td>Perspective</td>
<td><center>-</center></td>
<td>Rotate about pole</td>
</tr>

<tr>
<td bgcolor="#cccccc">Cylindrical</td>
<td>Cylindrical</td>
<td>Fisheye</td>
<td>Truncated fisheye</td>
<td>Warped fisheye</td>
<td>Perspective</td>
<td>Rotate left/right</td>
</tr>

<tr>
<td bgcolor="#cccccc">Spherical</td>
<td>Spherical</td>
<td>Fisheye</td>
<td>Truncated fisheye</td>
<td>Warped fisheye</td>
<td>Perspective</td>
<td>Rotate left/right</td>
</tr>

<tr>
<td bgcolor="#cccccc">Perspective</td>
<td>Perspective</td>
<td>Zoomed perspective</td>
<td>Fisheye</td>
<td>Warped fisheye</td>
<td><center>-</center></td>
<td>Pan left/right/up/down</td>
</tr>

</table>
</center><p>

<b>Keyboard control</b>
<ul>
<li>Space bar to start/pause movie playback.<p>
<li>Fast forward and reverse (new) using the "&lt;" and "&gt;" keys.<p>
</ul>

<b>Other features</b>
<ul>
<li>Full screen mode (of course) as required for most single projector systems,
optionally entered into at launch time.<p>
<li>Supports all the standard QuickTime video and audio codecs.<p>
<li>Option to automatically loop movie.<p>
<li>Drag/drop mode as well as Unix scriptable launching.<p>
<li>Default mesh (loaded at launch time) is called "default.data".<p>
</ul>

<b>Performance comments</b>
<p align="justify">
The performance is directly related to the underlying hardware being used, the penalty
for the warping part of the pipeline is minimal. Put another way, if the movie plays
smoothly in the QuickTime Player then it will most likely play smoothly in this player.
There are many factors involved when it comes to the playback of large frame movies, for
example, the codec used, the hard disk speed, the CPU type and performance, the graphics
card, and so on. At the time of writing the author has not had problems playing 1536x1536
pixel movies at 30fps on a 15" Mac Powerbook. Recent experiments with HD projectors have
been successful with a higher configured Powerbook, that is, playing 2000x2000 pixel movies
and creating 1920x1080 pixel warped images for spherical mirror projection.
The movie size, compression ratio, and performance will only increase over time.
</p>

<b>New: stereoscopic projection</a> (March 2008)</b><p>

<p align="justify">
The application has been enhanced to both support side-by-side stereoscopic movie
playback and to allow fullscreen playback across multiple displays. These are actually
related in the case where one is attempting passive stereo projection using a dual
display graphics card.
</p>

<center>
<img src="http://paulbourke.net/dome/warpplayer/preferences.jpg" width=479 height=280 border=0>
</center>

<h3>Example</h3>
<p align="justify">
As an example of the generally of this approach to realtime warping and to
demonstrate how warp maps might be generated, consider
the case of warping a fisheye into half a spherical projection.
</p>
<table width=100%><tr><td valign="top">
<pre>
#define NX 50
#define NY 50

int main(int argc,char **argv)
{
   int i,j;
   double x,y,u,v;
   XYZ p;
   double theta,phi,r;

   printf("2\n%d %d\n",NX+1,NY+1);
   for (j=0;j&lt;=NY;j++) {
      for (i=0;i&lt;=NX;i++) {
         x = -1 + 2 * i / (double)NX;
         y = -1 + 2 * j / (double)NY;
         theta = PID2 + x * PID2;
         phi = y * PID2;
         p.x = cos(phi) * cos(theta);
         p.y = cos(phi) * sin(theta);
         p.z = sin(phi);
         theta = atan2(p.z,p.x);
         phi = atan2(sqrt(p.x*p.x+p.z*p.z),p.y);
         r = phi / PID2;
         u = (1 + r * cos(theta)) / 2;
         v = (1 + r * sin(theta)) / 2;
         printf("%g %g %g %g 1\n",x,y,u,v);
      }
   }
   exit(0);
}
</pre>
</td><td valign="top">
	<a href="http://paulbourke.net/dome/warpplayer/fish2sph3.jpg"><img src="http://paulbourke.net/dome/warpplayer/fish2sph3s.jpg" width=400 height=455></a>
</td></tr></table><br><br><p>

<p align="justify">
Sample frame from a movie (left hand side)
and resulting spherical projection (right hand side).
</p>
<table width=100%><tr><td>
	<img src="http://paulbourke.net/dome/warpplayer/fish2sph1.jpg" width=380 height=380>
</td><td>
   <img src="http://paulbourke.net/dome/warpplayer/fish2sph2.jpg" width=380 height=380>
</td></tr></table><p>

<b>Truncated warp maps</b><p>

<p align="justify">
While the warpplayer was originally written for fisheye warping for the
spherical mirror projection technology, it is also useful for a wide family
of image warping, including geometry correction on flat walls and cylinders.
It is also useful for playing a fisheye movie onto truncated fisheye systems
without needing to pre-truncate the movie. The following provides warp mesh
files (right column) for all the common projector aspect ratios (4x3, 5x4,
16x9, and 16x10). Any truncation degree can be supported but only the ideal
optimal cases are provided here.
</p>

<center><table>

<tr><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/trunctop4x3.jpg" width= height= border=0>
</td><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/itrunctop4x3.jpg" width= height= border=0>
</td><td>
   <a href="http://paulbourke.net/dome/warpplayer/4x3_trunc_top.data">4x3_trunc_top.data</a><p>
   <a href="http://paulbourke.net/dome/warpplayer/4x3_trunc_bottom.data">4x3_trunc_bottom.data</a>
</td></tr>

<tr><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/trunctop5x4.jpg" width= height= border=0>
</td><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/itrunctop5x4.jpg" width= height= border=0>
</td><td>
   <a href="http://paulbourke.net/dome/warpplayer/5x4_trunc_top.data">5x4_trunc_top.data</a><p>
   <a href="http://paulbourke.net/dome/warpplayer/5x4_trunc_bottom.data">5x4_trunc_bottom.data</a>
</td></tr>

<tr><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/trunctop16x9.jpg" width= height= border=0>
</td><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/itrunctop16x9.jpg" width= height= border=0>
</td><td>
   <a href="http://paulbourke.net/dome/warpplayer/16x9_trunc_top.data">16x9_trunc_top.data</a><p>
   <a href="http://paulbourke.net/dome/warpplayer/16x9_trunc_bottom.data">16x9_trunc_bottom.data</a>
</td></tr>

<tr><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/trunctop16x10.jpg" width= height= border=0>
</td><td align="center">
   <img src="http://paulbourke.net/dome/warpplayer/itrunctop16x10.jpg" width= height= border=0>
</td><td>
   <a href="http://paulbourke.net/dome/warpplayer/16x10_trunc_top.data">16x10_trunc_top.data</a><p>
   <a href="http://paulbourke.net/dome/warpplayer/16x10_trunc_bottom.data">16x10_trunc_bottom.data</a>
</td></tr>

</table></center>
<p>

<b>Manually created mesh files</b><br>
<p align="justify">
It isn't always possible to derive the mappings mathematically. An example of
this might be the creation of a rectangular looking image on an arbitrary curved
surface. One way to derive the mesh for this is to create a regular grid on the
final surface and then from the perspective of the projector trace out the grid
lines. This last stage can be performed photographically or by tracing the grid
lines on the computer screen by projecting the same screen through the data
projector.
</p>
<center>
<a href="http://paulbourke.net/dome/warpplayer/pdiagram.pdf"><img src="http://paulbourke.net/dome/warpplayer/pdiagram.png" width=800 height=748 border=0></a>
</center>
<p align="justify">
In the example above one wishes to see an undistorted image from the viewer position
shown. The grid drawn on the surface gives the (u,v) coordinates of the image to be
projected. The traced or photographed position of the grid from the projector perspective
gives the (x,y) coordinates. 
</p>

<b>FAQ</b><p>
Can you tell how to choose which warpmesh to use in the 6 metre dome?<br>
<dd>
<p align="justify">
The main thing is the aspect ratio of the projector you are using, assuming you are driving it with a computer that is the same aspect ratio. For data projectors there are the following aspect ratios
</p>
<ul>
<li>4x3, is normally 1024x768 pixels, I don't recommend people use this for fulldome
projection. There are less common 1400x1050 pixel projectors.<br>
<li>16x9, this would normally be 1920x1080, the standard recommended resolution for
spherical mirror projection. There is 1280x720 which I also do not recommend.<br>
<li>16x10, this is less common and is normally 1920x1200 pixels. Doesn't give any real
advantage over 1920x1080.
</ul>
<p align="justify">
I have supplied samples of each of these with the warpplayer download.
The size of the dome is not relevant. These are canned warp mesh files, you adjust the
hardware to get a result that covers your dome. The other approach is to use meshmapper
(supplied with warpplayer) and create your own warpmesh file. Not a simple job but the
way to get the best results for your hardware.
</p>
</dd>

Can you provide some basic instructions?<br>
Basic operation, fast start<p>
<ul>
<li>Unzip the downlaoded archive.<br>
<li>Move the application "warpplayer.app" to a location on your hard drive of your choice<br>
<li>Determine the aspect ratio of your projector, 4:3, 16:9 or 16:10.<br>
<li>Rename the mapping data file corresponding to that aspect to "default.data", for example,
for a full HD projector (1920x1080) rename the mapping file supplied "standard_16x9.data"
to "default.data".<br>
<li>Place the file "default.data" in the same directory as the warpplayer software<br>
<li>Drag and drop a fisheye movie onto the warpplayer software.<br>
<li>Command (clover) - f to enter fullscreen, or use the Options menu fullscreen item.
See the preference which will automatically enter fullscreen or not. Note that it is
assumed that the projector and computer display are mirrored, see Displays preferences.<br>
<li>Space to pause / continue movie<br>
<li>Command (clover) - q to quit.<br>
</ul>

</td></tr></table><p>
</body>
</html>

