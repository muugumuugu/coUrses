<html>
<head>
<link rel=StyleSheet href="../../pdbstyle2.css" type="text/css" media=all>
<title>The Lorenz Attractor, a thing of beauty</title>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800><tr><td>

   <center>
   <h1>The Lorenz Attractor in 3D</h1>
   Images by <a href="../index.html">Paul Bourke</a><br>
   April 1997<p>
   <a href="dominic/index.html">MSWindows application</a> by Dominic van Berkel.
   <p>
   Listen (<a href="lorenz.mov">mov</a> or <a href="lorenz.mid">midi</a>) to the
   Lorenz attractor.<br>
   The three axes are each mapped to a different instrument.
   <p>
   <a href="lorenz.m4v">lorenz.m4v</a> for an iPod-video.
   </center>
   <p><br><p>

<center>
<table cellspacing=0 cellpadding=0 border=0><tr><td width=400>
	<font color="#ffcccc">
	<p align="justify">
	This image appeared in the Nature journal
	31 August 2000, pp 949 as part of an article titled
	The Lorenz Attractor Exists, written by Ian Stewart.
	It was created as part of an OpenGL interactive viewer
	and rendered on a farm of Dec Alphas using PovRay.
	</p>
	<p align="justify">
	Appeared in the book "What Shape is a Snowflake" by Ian Stewart,
	page 177.
	</p>
	<p align="justify">
	Appeared in Wiedzaizycie #7, July 2003, page 49.
	</p>
	<p align="justify">
	Appeared on a poster for the Second DANCE's Winter School: 
	Recent Trends in Nonlinear Science 
	Castellon, January 2005
	</p>
	</font>

</td><td width=50>
	&nbsp;
</td><td valign="top" width=350>
	<center>
	<a href="lorenz11.gif">
	<img src="lorenz11s.gif" border=1 width="250" height="387"></a>
	</center>
</td></tr></table></center>
<p><br><p>

<p align="justify">
The lorenz attractor was first studied by Ed N. Lorenz,
a meteorologist, around 1963. It was derived from a simplified model of 
convection in the earth's atmosphere. It also arises naturally in models
of lasers and dynamos. The system is most commonly 
expressed as 3 coupled non-linear differential equations.
</p>
<center>
dx / dt = a (y - x)
<p>
dy / dt = x (b - z) - y
<p>
dz / dt = xy - c z
</center>

<p align="justify">
One commonly used set of constants is a = 10, b = 28, c = 8 / 3.
Another is a = 28, b = 46.92, c = 4.
"a" is sometimes known as the <b>Prandtl</b> number and 
"b" the <b>Rayleigh</b> number.
</p>

<p align="justify">
The series does not form limit cycles nor does it ever reach a steady state.
Instead it is an example of deterministic chaos. As with other chaotic systems
the Lorenz system is sensitive to the initial conditions, two initial states
no matter how close will diverge, usually sooner rather than later.
</p>

Typical traces of each coordinate are shown below<p>
<center>
<img src="lorenz10.gif" width="584" height="357">
</center><p>

<p align="justify">
While the equations look simple enough they lead to wondrous trajectories,
some examples of which are illustrated below.
</p>

<center>
<img src="lorenz1.png" width="800" height="954"><br>
<img src="new1.png" width=800 height=600><br>
<img src="lorenz2.png" width="800" height="834"><br>
<img src="lorenz3.png" width="800" height="603"><br>
<img src="lorenz4.png" width="800" height="855"><br>
<img src="lorenz5.png" width="800" height="555"><br>
<img src="lorenz6.png" width="800" height="467"><br>
<img src="lorenz7.png" width="800" height="654"><br>
<img src="lorenz8.png" width="800" height="608"><br>
</center>
<p>

<table width=100%><tr><td valign=top>

<p align="justify">
A physical model simulating the Lorenz equations has been attributed
to Willem Malkus and Lou Howard around 1970.
It consists of leaking cups on the rim of a larger wheel as shown in
the diagram on the right. Liquid flows from the pipe at the top, each
cup leaks from the bottom.
<br>
Under different input flow rates you should be able to convince yourself
that under just the right flow rate the wheel will spin one way and then
the other chaotically. 
</p>

Of course you can always build it.....
</td><td width=30 valign=top>
&nbsp;
</td><td valign=top>
<img src="wheel.gif" width="313" height="416">
</td></tr></table>
<p>

<table width=100% border=0><tr><td>
<b>C source</b>
<font color="#aaffaa">
<pre>
#include "stdio.h"
#include "stdlib.h"
#include "math.h"

#define N 10000

int main(int argc,char **argv)
{
   int i=0;
   double x0,y0,z0,x1,y1,z1;
   double h = 0.01;
   double a = 10.0;
   double b = 28.0;
   double c = 8.0 / 3.0;

   x0 = 0.1;
   y0 = 0;
   z0 = 0;
   for (i=0;i&lt;N;i++) {
      x1 = x0 + h * a * (y0 - x0);
      y1 = y0 + h * (x0 * (b - z0) - y0);
      z1 = z0 + h * (x0 * y0 - c * z0);
      x0 = x1;
      y0 = y1;
      z0 = z1;
      if (i &gt; 100)
         printf("%d %g %g %g\n",i,x0,y0,z0);
   }
}
</pre>
</font>
</td><td align=right>
<a href="cartelfin.jpg"><img src="cartelfin_s.jpg" width=300 height=457></a>
</td></tr></table>

<p>
<center>
<img src="lorenzball.jpeg" border=2 width="600" height="790">
</center>
<p>

<p>
<p align="justify">
<b>PovRay 3.5 macro by Marcus Fritzsch</b>
</p>
<font color="#aaffaa">
<pre>
// N = number iterations
// h, a, b, c: initial parameters
// x0, y0, z0: start-location
// rad = radius of the spheres that trace the attractor

#macro lorenz(h, a, b, c, x0, y0, z0, N, rad)
// use it like:  
// lorenz(0.001099, 10, 28, 8/3, 0.0001, 0.0001, 0.0001, 350000, 0.04)
   #local i = 0;
   union {
   #while (i &lt; N)
       #local x1 = x0 + h * a * (y0 - x0);
       #local y1 = y0 + h * (x0 * (b - z0) - y0);
       #local z1 = z0 + h * (x0 * y0 - c * z0);
       #if (i &gt; 100)
           sphere {
              &lt;x0,y0,z0&gt;, rad
              pigment { color rgb &lt;i/N,i/N,1&gt; }
           }
       #end
       #local i = i + 1;
       #local x0 = x1;
       #local y0 = y1;
       #local z0 = z1;
   #end
   }
#end
</pre>
</font>
<p>

PovRay rendering by Marcus Fritzsch<br>
<center>
<img src="marcus.gif" border=0 width="700" height="693"><br>
</center>
<p>

<p align="justify">
The waterwheel actually built by Planeten Paultje for the 
Dutch Annual Physics Teacher Conference in December 2005, the
"Woudschotenconferentie Natuurkunde 2005".
</p>
<center><table><tr><td width=350>
	<a href="waterwheel1.jpg"><img src="waterwheel1s.jpg" width=300 height=225 border=1></a><br>
	<font size=-1>Experimental setup</font>
</td><td width=20>
&nbsp;
</td><td width=50%>
	<a href="waterwheel2.jpg"><img src="waterwheel2s.jpg" width=300 height=225 border=1></a><br>
	<font size=-1>Snapshot of chart recorder</font>
</td></tr></table></center><p>

<b>Second Life example</b>
<pre>
default {
    state_entry() {
        llOwnerSay("Touch to start build");
    }

    touch_start(integer total_number) {
        integer i;
        integer N = 3000;
        integer counter = 0;
        float a = 10;
        float b = 28;
        float c = 8/3.0;
        float h = 0.01;
        vector p0 = &lt;0.1,0,0&gt;;
        vector plast = p0;
        vector p1;
        vector offset = &lt;0,0,-1&gt;;
        float scalefactor = 0.15;

        offset += llGetPos();
        
        for (i=0;counter&lt;N;i++) {
             
            p1.x = p0.x + h * a * (p0.y - p0.x);
            p1.y = p0.y + h * (p0.x * (b - p0.z) - p0.y);
            p1.z = p0.z + h * (p0.x * p0.y - c * p0.z);
            llOwnerSay((string)i + " &lt;" + (string)p1.x + "," + (string)p1.y + "," + (string)p1.z +"&gt;");
            
            if (i &gt; 100) {
                //llRezObject("ball", p1+offset, ZERO_VECTOR, ZERO_ROTATION, 1); 
                rotation rot = llRotBetween(&lt;0,0,1&gt;,scalefactor*(p1-plast)); 
                integer len = (integer)(100*llVecMag(scalefactor*(p1-plast)));
                if (len &gt; 10) {
                    llRezObject("lineseg", offset + scalefactor*(p1+plast)/2, ZERO_VECTOR, rot, len);
                    plast = p1;
                    counter++;
                }
            } else {
                plast = p1;
            }
            p0 = p1;
        }
    } 
}
</pre>
<center>
	<a href="secondlife.jpg">
	<img src="secondlife_s.jpg" width=800 height=459 border=1></a>
</center>
<p><br><p>

<center>
   <a href="vevey.jpg">
   <img src="vevey_s.jpg" width=800 height=600 border=1></a><br>
	<font size=-1>Sculpture in Vevey, Switzerland</font>
</center>
<p><br><p>

</td></tr></table></center>
</body>
</html>

