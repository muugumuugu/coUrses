<html>
<head>
<link rel=StyleSheet href="../../pdbstyle2.css" type="text/css" media=all>
<title>Wada basins</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800 cellpadding=0 cellspacing=0><tr><td>

<table width=100% cellpadding=0 cellspacing=0><tr><td width=80%>
<center>
<h1>Wada basins</h1>
or<p>
<h1>Rendering chaotic scattering</h1>
Written by <a href="../index.html">Paul Bourke</a><bR>
December 1998
</center>
</td><td width=20%>
hello mudda<br>
hello fadda<br>
could you please get<br>
me some wada?<br>
<p align="right">
<font size=-1>(Gayla Chandler)</font>
</p>
</td></tr></table>
<center>
<p><br><p>

<table width=500 border=0 cellspacing=0 cellpadding=0><tr><td>
<p align="justify">
December 2000<br>
Here's a party trick for over Christmas. Get 4 large shiny Christmas balls,
some coloured wrapping paper, some lights from the Christmas tree,
and you have you own fractal laboratory to amuse yourself with over
the festive season.
</p>
</td></tr></table><p>
<a href="wada1.jpeg"><img src="wada1small.jpeg" width="500" height="278"></a>
</center>
<p><br><p>

<b>Introduction</b><br>
<p align="justify">
The following is a computer rendering that replicates the results
of experiments in chaotic scattering. 
Application of this occur in such diverse disciplines as fluid dynamics,
cosmology, celestial mechanics, thermodynamics, and atomic scattering.
The basic setup is four identical,
highly reflective balls sitting is a pyramid formation so that each
ball touches every other ball. One looks into the gaps between three 
balls and either shines light into all or one of the other gaps or
places coloured paper over the gaps and shines light into the same
gap one is looking into (or variations of the above). The resulting
multitude of reflections, fractal, has what is known as the Wada property after
the Japanese mathematician who studied these spatial divisions in 1917.
The Wada property refers to cases when there are three 
basins of attractions so convoluted that every point on a 
basin boundary is also on the boundary of all other basins.
</p>

<center>
<img src="model.gif" width=300 height="246">
</center>

<p align="justify">
You can do the real experiments yourself by getting 4 Christmas
tree balls or other shiny balls, placing coloured paper over some of the
gaps and/or shining light into the gaps.
Unfortunately the physical experiment can't be exactly 
replicated with rendering software because
raytracers don't trace light from the light sources back to the camera, rather
they trace "fake" rays from the camera back into the scene and finally
to the lights. The following image is a rendering from a position where
the balls and coloured planes can all be seen, for the coordinates of the
geometry see <a href="balls5.dat">balls5.dat</a>.
</p>

<center><a href="wada8.png">
<img src="wada8small.gif" width=300 height="300"></a>
</center>

<p align="justify">
The most important setting for a raytracer in order to replicate the
results here is to be able to set the number of reflections that will
be considered for each ray. Typically raytracers only trace back about
6 intersections before they evaluate the light contribution, for this
exercise the more reflections the better the result.
</p>

<center><a href="wada9.png">
<img border=1 src="wada9small.gif" width=414 height=300></a>
</center>
<p>

<p><br><p>
<b>Tachyon</b><br>
<p align="justify">
The images here were rendered using the Tachyon rendering package
written by John Stone. The same results could be achieved with almost
any raytracer, in particular PovRay, Radiance, etc. As mentioned before
it is important to be able to set the ray trace depth, it is also
important to be able to precisely set the position and radius of the
balls to avoid any narrow slits or intersections. The table below gives
the centre and radius of the 4 balls in the configuration used here.
</p>
<pre>
      x      y      z         r
    -0.5   -0.5    0.5   sqrt(2) / 2 
     0.5    0.5    0.5   sqrt(2) / 2 
    -0.5    0.5   -0.5   sqrt(2) / 2 
     0.5   -0.5   -0.5   sqrt(2) / 2
</pre>
<p align="justify">
In this example (<a href="balls2.dat">balls2.dat</a>)
a light is positioned behind the camera
illuminating the gap between the three front balls.
</p>
<center><a href="wada2.gif">
<img border=1 src="wada2small.gif" width="300" height="331"></a>
</center>

<p align="justify">
Models in Tachyon format are given below for the three
basic model configurations illustrated by the images on this page.
<br>
<a href="balls1.dat">balls1.dat</a><br>
<a href="balls2.dat">balls2.dat</a><br>
<a href="balls3.dat">balls3.dat</a><br>
<a href="balls5.dat">balls5.dat</a><br>
</p>

<p><br><p>
<b>PovRay</b><br>
<p align="justify">
For those who like PovRay, here is a model to use as a starting point
for exploration.
<br>
<a href="wada.ini">wada.ini</a><br>
<a href="wada.pov">wada.pov</a><br>
</p>
<p align="justify">
Third place (Artistry section) in the PovRay short code contest.
</p>
<center>
<a href="pdb_800.jpg">
<img src="pdb_800.gif" width=300 height=225></a>
</center>
<font color="#00ff00">
<pre>
global_settings {max_trace_level 1000}
#declare a=sqrt(2);
#declare r=texture{pigment{color<1,1,1>}finish{ambient 0
diffuse 1 reflection 1}}
camera{location x-y+z look_at<0,0,0>}
light_source{<-3,-3,-3>color<0,1,0>}
light_source{<-3, 3, 3>color<0,0,1>}
light_source{< 3, 3,-3>color<1,0,0>}
sphere{z-x-y,a texture{r}}
sphere{x+y+z,a texture{r}}
sphere{y-x-z,a texture{r}}
sphere{x-y-z,a texture{r}}
</pre>
</font>

<p><br><p>
<b>Radiance</b><br>
<p align="justify">
The following files might be useful as a way of
starting your exploration using the Radiance tracer.
</p>
<a href="wada.rad">wada.rad</a><br>
<a href="doit">doit</a><br>
</p>

<p><br><p>
<b>Vivid</b><br>
<p align="justify">
A Vivid model (<a href="wada.v">wada.v</a>) contributed
by Rasta Robert, example renderings are given below.
</p>
<table width=100% cellpadding=0 cellspacing=0><tr><td>
<center><a href="rasta_robert1.jpg">
<img border=1 src="rasta_robert1s.jpg" width="300" height="300"></a>
</center>
</td><td>
<center><a href="rasta_robert2.jpg">
<img border=1 src="rasta_robert2s.jpg" width="300" height="300"></a>
</center>
</td></tr></table><p>

<p><br><p>
<b>Polyray</b><br>
<p align="justify">
A Polyray model (<a href="wada.pi">wada.pi</a>) contributed by
Rasta Robert.
</p>

<p><br><p>
<b>Bryce</b><br>
<p align="justify">
Contribution by Luc Benard, 3 silver spheres and one gold with a pink
cube in the inner space.
Bryce model: <a href="FB1.br5">FB1.br5</a>.</p>

<table width=100% cellpadding=0 cellspacing=0><tr><td>
<center><a href="luc1.jpg">
<img border=1 src="luc1s.jpg" width="300" height="190"></a></center>
</td><td>
<center><a href="luc2.jpg">
<img border=1 src="luc2s.jpg" width="300" height="190"></a></center>
</td></tr></table><p>

<table width=100% cellpadding=0 cellspacing=0><tr><td>
<center><a href="fb1.jpg">
<img border=1 src="fb1s.jpg" width="300" height="235"></a></center>
</td><td>
<center><a href="fb2.jpg">
<img border=1 src="fb2s.jpg" width="300" height="235"></a></center>
</td></tr></table><p>

<p><br><p>
<b>Further examples</b><p>

<p align="justify">
In this and subsequent examples (<a href="balls3.dat">wada3.dat</a>) 
the coloured paper covering
the gaps has been replaced by coloured light sources.
There is a coloured light at three
of the gaps and the camera is located at the other gap.
</p>

<center><a href="wada3.png">
<img src="wada3small.jpeg" width="281" height="300"></a>
</center>
<p>

<p align="justify">
You can generate
this rendering at high resolutions and the colour of any particular spot
on the spheres will be arbitrarily close to another colour. 
</p>

<table width=100% cellpadding=0 cellspacing=0><tr><td width=50%>
<center><a href="wada4.png">
<img border=1 src="wada4small.gif" width="300" height="300"></a>
</center>
</td><td>
<center><a href="zoom1.jpeg">
<img border=1 src="zoom1small.jpeg" width="300" height="300"></a>
</center>
</td></tr></table><p>

<p align="justify">
The left image below 
is a view from the origin looking out one of the gaps with a single
green light source shining into the same gap (the light source itself
can't be seen). The image on the right is looking in the opposite direction.
</p>
<table width=100% cellpadding=0 cellspacing=0><tr><td width=50%>
<center><a href="wada6.gif">
<img border=1 src="wada6small.gif" width="300" height="300"></a>
</center>
</td><td width=50%>
<center><a href="wada7.gif">
<img border=1 src="wada7small.gif" width="300" height="300"></a>
</center>
</td></tr></table><p>

<p align="justify">
"Sitting" at the origin looking at one of the touching points of two
spheres (on the left).
</p>
<p><center><a href="wada5.png">
<img border=1 src="wada5small.gif" width="613" height="300"></a>
</center>

<p><br><p>
<b>References</b><p>

Complex topology in chaotic scattering: a laboratory observation<br>
D. Sweet, E. Ott, J.A. Yorke.<br>
Nature 399, 315 (1999)<br>
<p>

Basins of Wada<br>
Kennedy, J. & Yorke, J.A.<br>
Physica D 51, 213-225, 1991
<p>

Chaotic scattering in several dimensions<br>
Q. Chan, M. Ding, E Ott.<br>
Phys Letters. A 115, 93-100 (1990)<br>
<p>

Fractal basin boundaries<br>
McDonald, S.W., Grebogi, C., Ott, E. & Yorke, J.A.<br>
Physica D 17, 125-153, 1985<br>
<p>

Fractal basin structure<br>
Takesue, S. & Kaneko, K.<br>
Progr. Theor. Phys. 71, 35-49, 1984<br>
<p>

Fractal and Wada basin boundaries in quasiperiodically driven systems<br>
U. Feudel, A. Witt, Y.-C. Lai, and C. Grebogi<br>
Physical Review E 58, 3060-3066 (1998). <br>
<p>

Basins of attraction<br>
H.E. Nusse, J.A. Yorke<br>
Science 271, 1376-1380 (1996)<br>
<p>

</td></tr></table></center>
</body>
</html>
