<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>Approaches to Modelling the Surface of the Human Cortex</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>



<center>
<h1>Approaches to Modelling the <br>Surface of the Human Cortex</h1>
<h3>Survey and Examples of Current Techniques</h3>
Written by <a href="../index.html">Paul Bourke</a>
<br>
October 1996
</center>
<p><br><p>

This note will describe various approaches to creating
a polygonal based representation of the human cortical surface.
Traditionally computer based surface modelling deals with either
objects which can be represented by a number of essentially
flat bounded planes (facets), for example: a table or building
or objects made up of smooth curves, for example: a telephone or apple. 
These smooth surfaces are often formed by combinations of bounded
parametric functions called patches. These patches form elegant
and efficient descriptions but can be difficult to design and
manipulate. Alternatively, and perhaps more commonly
these smooth surfaces are approximated a large number of facets.
This facet approach, while usually inefficient, is considerably
easier to deal with numerically and must easier to create in an
automated way from sampled data.
<p>
By comparison to the objects normally subject to computer modelling
the surface of the human cortex is an incredibly complicated surface.
Some idea of the geometric complexity can be seen in the following diagram. 
Note the folding and the sulci which typically extend inwards by 
one third of the radius.
<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex1.gif">
</center>
<p>
Creating computer based representations of the human brain is an active
area of research. 
A distinction
should be clearly made between surface models and voxel models, the later
will not be discussed here except where it is the starting point for a surface
derivation as in techniques based on the tomographic methods and the
marching cubes algorithm.
<p>
<b>Note</b>: In the computer renderings used here to represent surface
models I have intentionally not used smooth shading techniques which
in many cases would greatly improve the appearance of the image. 
The underlying geometry is illustrated better with plane shading algorithms.

<p><b>Manual surface sampling</b><p>
A model resulting from a manual digitisation of a plastic cast is
available from ViewPoint DataLabs.
The model shown below consists of over 24,000 planar facets and 
is the most complex they have to offer to date.
<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex3.gif">
</center>
<p>
An obvious characteristic of this model is the even distribution of
vertices which tend to follow the structure of the surface. In addition
the facet density is function of detail, a highly desirable feature.
<p>
This approach, while totally manual, has the potential to create well
designed and efficient surfaces. The primary disadvantage is the reliance
on some sort of solid original. The rendering shows the relative flatness
of large portions of the surface at a larger scale than the facet approximation.
The sulci are also not nearly deep enough nor is the separation between the
two hemispheres.


<p><b>Surface reconstruction from contours</b><p>
Many scanning devices, such as MRI, result in slices through an object, 
each each 2D slice is normally presented as a grey scale image.

<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex7.gif">
</center>
<p>
Each pixel in the image
corresponds to some characteristic at that point in space, for example
protein density in MRI or X-ray absorption in CT scans. 
These images stack together to form a solid representation of the head. 
The contour approach attempts to trace the outline of the characteristic of
interest and use these contours to form the surface. 
<p>
The following example is created from contour data sourced from Brigham
and Womens Hospital. 
There are a total of 15 contours (for one hemisphere)
made up of approximately 3400 vertices.

<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex2.gif">
</center>
<p>
Note that there may be multiple contours at along any slice but,
as is typical of most data from tomographic techniques, the
spaces between the slices is large compared to the detail in
the plane of the slice.. 
<p>
The following surface model was created from these contours using 
a set of software tools (<i>Nuages</i>) by Bernard Geiger. These tools together
form surfaces between adjacent contours based on 3D Delaunay triangulation.

<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex4.gif">
</center>
<p>
This approach would seem to offer hope in forming highly convoluted
surfaces, however the automatic reconstruction of the surface from disjoint
contours is numerically problematic.


<p><b>Voxel based reconstruction</b><p>
Surface reconstruction from voxel datasets generated by MRI 
(Magnetic Resonance Imaging) typically
use a variant of the <i>marching cubes</i> algorithm by Lorensen and Cline
to create the surface.
Before this can occur a process usually called segmentation is performed
to enhance the surface boundary of interest within the volume.
Segmentation will not be discussed further here except
to say that it has been extensively studied with as yet no clear solutions.
Unfortunately the quality of the generated surface is heavily influenced 
by the quality of the segmentation.
<p>
The following examples were supplied by Dennis Strelow from original
data and segmentation provided by Robert Grzesczuk and David Levin.
Due to the enormous number of triangular facets that result from
marching cubes, the mesh is normally simplified (decimated) in such
a way as to attempt to retain the geometric features.
<p>
The following image shows the surface decimated to about 22500 vertices
and 45000 triangles. The most noticeable feature of such surfaces is the
regular grid the polygon vertices lie on. The cubic voxels, which were the 
basis of this model, are obvious.

<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex6.gif">
</center>
<p>
The following is the same geometry after a relaxation process has been
applied which smooths out the sharp discontinuities. 
This relaxed surface has the same
number of triangular facets but the vertices are moved so as to
generate a smoother representation while still attempting to retain
the features of the surface geometry.

<p><center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex5.gif">
</center>

<p><b>References</b><p>

Dennis W.Strelow, Clinton S. Potter, Paul C. Lauterbur<br>
The Construction and Visualisation of Surfaces from MHRI Data<br>
<i>June 1996</i><p>

William Erensen, Harvey E. Cline<br>
Marching Cubes: A high Resolution 3D Surface Construction Algorithm<br>
<i>Computer Graphics, 21(4):163-169, 1987</i><p>

William J.Schroeder, Jonathan A. Zarge, William E. Lorensen<br>
Decimation of Triangle Meshes<br>
<i>Computer Graphics, 26(2):65-70, 1992</i><p>

Bernard Geiger<br>
Three-Dimensional Modelling of Human Organs 
and its Application to Diagnostic and Surgical Planning<br>
<i>PhD Thesis, 1993</i><p>

J.D. Boissonnat<br>
Shape Reconstruction from Planar Cross-Sections<br>
<i>Computer Vision, Graphics, and Image Processing, 44:1-29,1988</i><p>


<p><br><br><br><p>


<center>
<h1>Modelling the Surface of the Human Cortex <br>
from MRI Volumetric Data</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
July 1997
</center>
<p><br><p>

<center><img src="http://paulbourke.net/miscellaneous/cortex/implb15.gif" width=600 height=600 border=1></center><p>

<p><b>MRI dataset</b><p>
The MRI dataset for this evaluation was kindly provided by Dr. F. Kruggel
of the Max-Planck-Institute of Cognitive Neuroscience
Inselstrasse 22-26, 04103 Leipzig, Germany. Described as:
<br>
<center>
<table width=80%><tr><td>
<blockquote>
T1-weighted, GRE or MDEFT sequence, 256x256 in-plane resolution,
FOV 250mm, 128 sagittal slices, 1.5mm thick, no gap.
In these raw datasets we remove the outer hulls of the brain ("brain
peeling"), align them with the stereotactical coordinate system
and interpolate them to 1mm^3 resolution.
</blockquote>
</td></tr></table><p></center>

Typical cross sections of MRI volume, 1mm<sup>3</sup>, 1 mm : 1 pixel<p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/implright.gif"></center><p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/implfront.gif"></center><p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/impltop.gif"></center><p>
<p>
The white matter which was used to form the basis of the implicit 
surface controls consisted of a clear band of intensity values, 
from 135 -> 215.
<p>
The control points are shown below in green for representative
slices along each of the three orthogonal planes. Each control point
is considered to be a sphere of 1mm radius so as to avoid overlapping.
<p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/implfront_c.gif"></center><p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/implside_c.gif"></center><p>
<center><img src="http://paulbourke.net/miscellaneous/cortex/impltop_c.gif"></center><p>

<p><b>Implicit surface modelling</b><p>

In this initial experiment the implicit surface function used is usually
called blobby molecules and attributed to Jim Blinn.
The field D at a distance r from a single control point is given by
a Gaussian
<center><p>
D(r) = A e <sup>-Br<sup>2</sup></sup>
<p></center>

For a number of control points the field at a point is the sum of
the field strengths from each control point.
<p>
The control points were created within the white matter, an isosurface
of this resulting field is an approximation to the cortex layer. In
what follows the isosurface was taken to be at a level of 0.5, and A = 1.

<center><img src="http://paulbourke.net/miscellaneous/cortex/implfcn.gif"></center><p>

<table width=100%><tr><td valign=top>
The approximate value of B can be determined by considering two
adjacent control points and the field at points between them.
B should be chosen so that the isosurface from two adjacent control
points is approximately cylindrical.
<p>
Varying B effectively creates isosurfaces at varying distance from
the white matter. High B result in isosurfaces that are close to the
white matter (close to the control points),
low B results in more distant isosurfaces
(diffuse field and smoother isosurface)....
Some example for B = 0.1 to 0.25 are illustrated below.<p>
</td><td>
<img src="http://paulbourke.net/miscellaneous/cortex/implsketch.gif">
</td></tr></table>

<table width=100%><tr><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/implb10.gif"><img src="http://paulbourke.net/miscellaneous/cortex/implb10small.gif"><br>B = 0.1</a>
</td><td  align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/implb15.gif"><img src="http://paulbourke.net/miscellaneous/cortex/implb15small.gif"><br>B = 0.15</a>
</td><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/implb20.gif"><img src="http://paulbourke.net/miscellaneous/cortex/implb20small.gif"><br>B = 0.2</a>
</td><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/implb25.gif"><img src="http://paulbourke.net/miscellaneous/cortex/implb25small.gif"><br>B = 0.25</a>
</td></tr></table>
<p>

<p align="justify">
The second experiment was to consider each pixel in the MRI volume
to be a control point, the intensity of the pixel being used to determine
the value of A in the blobby molecule field equation. The mapping from
intensity to A would be such that the white matter would result in high
positive values, pixels clearly outside the cortex would result in
negative values of A. It was hoped that this would help in the resolving
of the sulci, preventing bridging between gyri.
</p>

<table width=100%><tr><td>
The function used was a Gaussian with a mean of 175 and standard
deviation 40, namely<p>
<center>
e<sup>-[(x - 175)/40]<sup>2</sup></sup> - 0.1
</center><p>
The zero crossings are approximately at intensities 114 and 235,
in other words all intensities below 114 resulted in negative field
contributions.
</td><td valign=top>
<center><img src="http://paulbourke.net/miscellaneous/cortex/impl2.gif"></center>
</td></tr></table>

<table width=100%><tr><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/impla05.gif"><img src="http://paulbourke.net/miscellaneous/cortex/impla05small.gif"><br>B = 0.05</a>
</td><td  align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/impla10.gif"><img src="http://paulbourke.net/miscellaneous/cortex/impla10small.gif"><br>B = 0.10</a>
</td><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/impla15.gif"><img src="http://paulbourke.net/miscellaneous/cortex/impla15small.gif"><br>B = 0.15</a>
</td><td align=center>
<a href="http://paulbourke.net/miscellaneous/cortex/impla25.gif"><img src="http://paulbourke.net/miscellaneous/cortex/implb25small.gif"><br>B = 0.25</a>
</td></tr></table>

<p><b>Credits</b><p>

The implicit surfaces were rendered by polygonising the surface using
a modified marching cubes algorithm written by myself....that's another story.
<p>
The resulting polygonal surfaces were rendered using Geomview on an
SGI Maximum Impact.
<p>
Movies of the MRI slices in the three planes were generated using
Apple QuickTime (animation) technology.

<p><b>References</b><p>

James F. Blinn<br>
A Generalization of Algebraic Surface Drawing<br>
ACM Transactions on Graphics, July 1982<p>

Tatsumi, H., Takaoki, E., Omura, K. and Fujito, H.<br>
A new method for 3D reconstruction from serial sections by 
computer graphics using meta-balls: reconstruction
of "Hepatoskeletal System" formed by Ito Cells in the Cod Liver<br> 
Computers and Biomedical Research, 1990<p>

Brian Wyvill, Geoff Wyvill<br>
Field Functions for Implicit Surfaces<br>
Visual Computer, Issue 5 1989<p>

F. Kruggel, G. Lohmann<br>
Automatic Adoption of the Stereotactical Coordinate System in
MRI Datasets<br>
Information Processing in Medical Imaging
Duncan J, Gindi G (eds.), LCNS 1230, Springer 1997.<p>

<p><br><br><br><p>

<table width=100% cellspacing=0 cellpadding=0 border=0>
<tr><td>
<center>
<h1>Modelling the Surface of the Human Cortex</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
February 1997<p>
<p align="justify">
A low resolution version of this model is available 
in the "OFF" file format as specified by the GeomView
documentation:
<a href="http://paulbourke.net/miscellaneous/cortex/60000.off.gz">60000.off.gz</a> (20000 faces)
or <a href="http://paulbourke.net/miscellaneous/cortex/60000.dxf.gz">60000.dxf.gz</a>
Higher resolution versions are available on request.
</p>
</center>
<p><br><p>
</td><td width=320 align=right>
<p>
<center>
<a href="http://paulbourke.net/miscellaneous/cortex/cortex9.gif" width=300 height=227>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex9s.gif">
</a>
</center><p>
</td></tr></table><p>

<center>
<img src="http://paulbourke.net/miscellaneous/cortex/cortex0.gif" width="600" height="461" border=1>
</center>

<p><b>Introduction</b><p>

<p align="justify">
The following informally describes a project aimed at generating a
computer based surface model of a human cortex. The requirements
were for a "clean" facet based model that could be used for other
applications that required a surface model rather than volumetric
information. In particular it was necessary to derive a model with
a realistic representation of the deep sulci, a feature missing from
existing surface models.
</p>

<p><b>Slices</b><p>

<p align="justify">
It was decided early on to use cryosection data due to its high
resolution compared to MRI and other volumetric datasets available
at the time.
</p>

<p align="justify">
The source for the slices used in this reconstruction is the "Human Cryotome 
Data" from the UCLA Laboratory of Neuro Imaging.
</p>

<center><table width=80%><tr><td>
<p align="justify">
The data set contains images collected from the brain of a 76 year old
normal female human cadaver. The specimen was prepared for
sectioning by perfusing with 8% formalin, cryoprotecting with 10%
glycerol, freezing in isopentane and dry ice and blocking in green
tempera paint and 3% sucrose solution. The brain was cryosectioned
at -20<sup>o</sup>C through the horizontal plane in 100um increments on a
heavy duty cryomacrotome (PMV Stockholm, Sweden). The
cryomacrotome was equipped with a high resolution camera for
digital image capture of serial images (10242, 24-bit) collected from
the cryoplaned specimen blockface at every 600um. The actual image
size was measured at 18.5 cm. Data were assigned real value
coordinate values in micrometers for width, height, and depth and
reconstructed to a single 3D data volume. In order to place the brain
into the Talairach system, different amounts of scaling were imposed
on 12 rectangular regions of brain defined by vectors from the AC-PC
line and the extrema. 
</p>
</td></tr></table></center><p>

Examples of the slices<p>
<p><center><img src="http://paulbourke.net/miscellaneous/cortex/cortex8.gif" width="700" height="205"></center><p>
In total there were 317 slices.

<p><b>Tracing</b><p>

<p align="justify">
Every second section of the left hemisphere was traced with a 
third order B-Spline curve resulting in 168 slices. The software
to perform this tracing was written in-house, it is a Macintosh
program which reads a PICT file and optionally an existing spline
file. The user may manipulate the spline tracing by moving, adding,
or deleting control points. The spline curve is drawn interactively
so the user has an immediate feedback as to the closeness of fit.
</p>

Some examples of traced sections
<p><center><img src="http://paulbourke.net/miscellaneous/cortex/cortex12.gif" width="500" height="407"></center><p>

Needless to say the process of tracing each slice is tedious.

<p>
The overall dimensions for the model are
<p><center><img src="http://paulbourke.net/miscellaneous/cortex/cortex11.gif" width="390" height="400"></center><p>

<p><b>Surface Construction</b><p>

<p align="justify">
The reconstruction of the cortical surface from the parallel B-Spline 
sections is still being considered. Linear interpolation between the 
spline slices was used here, it is straightforward but results in a 
surface with undesirable structure perpendicular to the slices. 
Another method evaluated involved stacking the spline sections
together and spline curves are lofted perpendicular to the slice 
sections through the equivalent points on each section.
</p>

<p align="justify">
Improved reconstruction approaches include spline surface descriptions, 
implicit surfaces, and spherical harmonics. 
</p>

<p align="justify">
The aim is to derive a surface description which is "well behaved"
and can ideally be constructed at variable degrees of detail.
</p>
Half a dozen slices connected together are shown below.

<p><center><img src="http://paulbourke.net/miscellaneous/cortex/cortex13.gif" height="495" width="600"></center><p>

<p align="justify">
At this stage it is possible to estimate any position on the 2D spline
surface and thus form triangular facet versions 
of the cortex surface of any desired resolution
(up to some maximum as determined by the original sampling and slice
thickness).
The model seen at the start of this page was created by specifying
a maximal edge length for the triangular facets of 1mm.
</p>

<p><b>Editing/smoothing</b><p>

<p align="justify">
Due to variations in the slice splines such as image registrations
errors, the final reconstructed surface has undesirable vertical
features (see left image below). A standard relaxation filter was passed
over the surface to smooth it out, the effect is shown below.
</p>

<p><center><img src="http://paulbourke.net/miscellaneous/cortex/cortex10.gif" width="700" height="308"></center><p>

<p align="justify">
The algorithm used is applied repeatedly depending on the degree of
smoothing required, two iterations were used to create the final 
cortical model seen at the top of this page.
</p>

<table width=40% align=right><tr><td width=100%>
<font size=-1>
<p align="justify">
All the software required for the above was written by myself, 
The rendering was performed using Geomview on an SGI Max Impact. 
</p>
</font>
</td></tr></table><p>


<p><br><br><br><p>


<table width=100%><tr><td valign=center>
<center>
<h1>Images of fibres in a model of the cortex</h1>
Written and created by <a href="../index.html">Paul Bourke</a><br>
May 1997
</center>
</td><td valign=top>
<a href="http://paulbourke.net/miscellaneous/cortex/benchpress.gif">
<img src="http://paulbourke.net/miscellaneous/cortex/benchpresssmall.gif"></a></center>
</td></tr></table>

<p><br><p>

Illustration of a computer generated connectivity between discrete areas
on a human cortex. Two modelling exercises have been combined in this
illustration; the formation of a realistic surface representation of
the human cortex and the result of a simulation to derive pathways by
which fibre bundles connect surface patches.
<p>

<table width=100% cellspacing=0 cellpadding=0><tr><td width=50%>

Generating a realistic surface representation of the human cortex 
involves a reconstruction from geometric data acquired from a real 
cortex. A common approach is to use MRI scans which come in the 
form of a number of 2 dimensional slices (images) through the 3 
dimensional volume. While there may be sufficient resolution within 
a slice, the resolution perpendicular to the slices is much poorer 
resulting in inadequate spatial sampling in that dimension. It is 
thus not possible, or at least very difficult, to get a realistic 
reconstruction of deep sulci using MRI data. The approach taken 
here was to reconstruct the surface geometry from cryosection 
slices for which there is significantly better resolution both 
within a slice and between slices. The cryosection data was 
sourced from the UCLA Laboratory of Neuro Imaging, each slice 
is separated by 0.6mm and was digitally photographed at 1000x1000 
pixel resolution. The upper cortical surface was traced using a 
mixture of automatic and manual procedures to form ribs over 
which 2 dimensional splines were lofted. This parametric form 
of the cortical surface can be sampled at any user selected 
resolution to give simpler surface representations approximated 
by triangular facets.
<p>
The cortical simulation software being developed within the 
Brain Dynamics Laboratory requires information on how small 
areas (patches) on the cortex are coupled together, that is, 
the strength of coupling and delay between any two patches. 
Both of these parameters are functions of the distance of the 
pathway taken by the fibre bundle. The pathways were derived by 
modelling the cortex as a positively charged surface and a fibre 
as a collection of positively charged springs connected end-to-end 
along the pathway. The fibre path is found by iteratively relaxing 
the spring model to find the route of minimum potential energy. 
This model gives the desired properties we chose for the fibre 
pathways, the fibres are roughly perpendicular to the surface 
of the cortex, they attempt to find the shortest route between 
patches, and they don't intersect the surface or each other. For 
this type of whole brain macroscopic simulation the surface of 
the cortex was split into about 600 patches. Fibres from any one 
patch can potentially connect to any other patch resulting in a 
huge number of fibres. In practice however, the very long or 
convoluted pathways have a very small coupling value and can be 
safely pruned. Additional long range fibres representing the 
superior longitudinal fasciculus, inferior longitudinal fasciculus, 
and unicinate fasciculus were also added to the model. These 
additional longer range fibres have their pathways determined 
by similar techniques but their coupling strength is based upon 
a different function of distance.
<p>
</td><td width=50% valign=top>
<p><center><img src="http://paulbourke.net/miscellaneous/cortex/fibre1.gif"></center><p>
</td><tr></table>

The illustration is a view from above showing the surface of the
cortex as transparent facets with black edges. The fibres are
drawn as blue spline curves connecting the centers of the surface
patches.

<p><center><img src="http://paulbourke.net/miscellaneous/cortex/fibre2.gif"></center><p>

</body>
</html>
