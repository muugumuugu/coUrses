<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>Least Squares</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800><tr><td>

<center>
<h1>Least Squares</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
June 1997
</center>
<p><br><p>

One often has a number of data points and the need to describe the
behaviour of the
data with a function of a known form. In general the data points
are noisy samples and the functions parameters can't be chosen so as
to exactly describe all the samples. The desire then is to find the
parameters of the function that "best" describe the samples.
<p>
The method of least squared error is one common choice of the "best" estimate.
The squared error is the sum of the squared differences between each sample
and the expected value as predicted by the function.
The parameter values that minimise this error are considered the best estimates.
<p>
The first example will illustrate the key points behind the technique
by applying it to a problem that can readily be worked out manually.

<h3>Example 1</h3>
Consider finding the equation of a straight line given n samples 
(x<sub>i</sub>,y<sub>i</sub>). We will fit the function f(x) = ax + c,
the normal definition of a linear function where a is the slope, and
c is where the line intercepts the y axis.
The key features and conventions are illustrated below.
<p>
<center>
<img src="http://paulbourke.net/miscellaneous/leastsquare/least3.gif">
</center>
<p>
The general expression for the least square error E is defined as<p>
<center><img src="http://paulbourke.net/miscellaneous/leastsquare/least1.gif">
</center><p>
In this particular case it is<p>
<center><img src="http://paulbourke.net/miscellaneous/leastsquare/least2.gif">
</center><p>
This function will have a minimum where the first derivatives with
respect to a and c are 0.<p>
<center>
dE/da = 0 = 
(ax<sub>0</sub> + c - y<sub>0</sub>)x<sub>0</sub> +
(ax<sub>1</sub> + c - y<sub>1</sub>)x<sub>1</sub> +
... + 
(ax<sub>n-1</sub> + c - y<sub>n-1</sub>)x<sub>n-1</sub> 
<p>
DE/dc = 0 = 
(ax<sub>0</sub> + c - y<sub>0</sub>) +
(ax<sub>1</sub> + c - y<sub>1</sub>) +
... +
(ax<sub>n-1</sub> + c - y<sub>n-1</sub>)
<p>
</center>
These can be rewritten as<p>
<center>
a (x<sub>0</sub>x<sub>0</sub> + x<sub>1</sub>x<sub>1</sub> +
... + x<sub>n-1</sub>x<sub>n-1</sub>) +
c (x<sub>0</sub> + x<sub>1</sub> + ... + x<sub>n-1</sub>) = 
x<sub>0</sub>y<sub>0</sub> + x<sub>1</sub>y<sub>1</sub> +
... + x<sub>n-1</sub>y<sub>n-1</sub>
<p>
a (x<sub>0</sub> + x<sub>1</sub> +
... + x<sub>n-1</sub>) +
c (1 + 1 + ... + 1) =
y<sub>0</sub> + y<sub>1</sub> +
... + y<sub>n-1</sub>
<p>
</center>
From the above it might be observed that if we define the vectors
<p><center>
<b>x</b> = (x<sub>0</sub>, x<sub>1</sub>, x<sub>2</sub>, ... x<sub>n-1</sub>)
<p>
<b>y</b> = (y<sub>0</sub>, y<sub>1</sub>, y<sub>2</sub>, ... y<sub>n-1</sub>)
<p>
<b>u</b> = (1,1,1,... 1) 
</center><p>
then we can write the problem as two simultaneous equations
with two unknowns, a and c as follows<p>
<center>
a <b>x</b>.<b>x</b> + c <b>x</b>.<b>u</b> = <b>x</b>.<b>y</b><p>
a <b>u</b>.<b>x</b> + c <b>u</b>.<b>u</b> = <b>u</b>.<b>y</b><p>
</center>
Where "." refers to the vector dot product. <p>
Solving the above two equations for a and c is straightforward. In general
all least squares estimates irrespective of the type of function or
how many parameters can be formulated into an set of simultaneous
equations. There are the same number of equations as there are unknowns
or parameters to be fitted.

<p>
<h3>Example 2</h3>
To fit a plane f(x,y) = ax + by + c given samples
<p><center>
<b>x</b> = (x<sub>0</sub>, x<sub>1</sub>, x<sub>2</sub>, ... x<sub>n-1</sub>)
<p>
<b>y</b> = (y<sub>0</sub>, y<sub>1</sub>, y<sub>2</sub>, ... y<sub>n-1</sub>)
<p>
<b>z</b> = (z<sub>0</sub>, z<sub>1</sub>, z<sub>2</sub>, ... z<sub>n-1</sub>)
</center><p>
and applying the same derivation as in the case of the line we get
3 simultaneous equations and 3 unknowns<p>
<center>
a <b>x</b>.<b>x</b> + b <b>x</b>.<b>y</b> + c <b>x</b>.<b>u</b> = 
<b>x</b>.<b>z</b><p>
a <b>y</b>.<b>x</b> + b <b>y</b>.<b>y</b> + c <b>y</b>.<b>u</b> =
<b>y</b>.<b>z</b><p>
a <b>u</b>.<b>x</b> + b <b>u</b>.<b>y</b> + c <b>u</b>.<b>u</b> =
<b>u</b>.<b>z</b><p>
</center>
These and larger sets of simultaneous equations can be readily solved
using standard Gaussian elimination, 
<a href="../gausselim/index.html">see here</a> for more details and source code.


<td></tr></table></center>
</body>
</html>

