<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>Waldram Diagrams</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800><tr><td>

<center>
<h1>Waldram Diagrams</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
March 2018
</center>
<p><br><p>

<p align="justify">
A Waldram diagram is used to calculate the percentage of sky
that a building allows to the street below. As a relatively old technique it
has the merit of being able to realidy drawn by hand given the profile of the
building. Of course one might also interested in automatically creating such drawings, 
where they are required by councils for new buildings, from ones 3D models of
the building and site.
</p>

<p align=justify">
The four cases considered here are:
</p>
<ul>
<li>Uniform sky and horizontal plane<br>
<li>Overcast sky (CIE) and horizontal plane<br>
<li>Uniform sky and vertical plane<br>
<li>Overcast sky (CIE) and horizontal plane<br>
</ul>
<p align="justify">
They can be applied over a 1/4 sphere (1/2 hemisphere) or a 1/2 sphere (hemisphere).
In both cases the horizontal axis of longitude range from -&pi;/2 to &pi;/2. The vertical
axis ranges from latitude 0 to &pi;/2 for the 1/4 sphere, and latitude -&pi;/2 to
&pi;/2 for 1/2 sphere case.
</p>

<p align="justify">
The position on the vertical axis as a function of latitude (x) is as follows
for each of the 4 cases. The horizontal axis is either proportional to the 
longitude (first 2 cases) or sine of the longitude (second 2 cases).
</p>
<center>
	<img src="http://paulbourke.net/miscellaneous/Waldram/equations.png" width=200 height=138 border=0>
</center><p>
<center>
   <img src="http://paulbourke.net/miscellaneous/Waldram/graph.png" width=600 height=404 border=0>
</center><p>

<p align="justify">
Since realtime graphics APIs such as OpenGL, and the higher level tools
based upon them, do not immediately support other than orthographic and
perspective projections, a common way to create arbitrary projections is
outlined <a href="../../dome/cube2fish/index.html">here for creating fisheye projections</a>.
In essence one captures three or four 90 degree field of perspective projections,
where the view frustum is defined by the vertices of the faces of a cube. This
is variably known as cube maps or cubic environments. 
Four faces are sufficient to capture what is visible in a hemisphere, note the
virtual camera in the center of the cube points towards the midpoint along an edge
rather than the more usual center of a face of the cube.
These three or four renders are then applied to a mesh designed to achieve the
correct mapping.
</p>

<p align="justify">
The first case of a uniform sky on a horizontal plane (quarter sphere) is 
illustrated below. The first figure shows the left, right and top face of the
cube. Note that in all cases only half the cube face is actually used.
</p>
<center>
   <img src="http://paulbourke.net/miscellaneous/Waldram/faces.png" width=800 height=405 border=0>
</center><p>
<p align="justify">
The mesh nature is shown below, the transformation is conveyed in the vertex
positions, the uv texture coordinates at each vertex carry the longitude and
latitude values from the original cube faces.
</p>
<center>
   <img src="http://paulbourke.net/miscellaneous/Waldram/mesh.png" width=800 height=405 border=0>
</center><p>
<p align="justify">
And finally the classical shape of horizontal features, in this case 8 thin 
cylinders extending from far left (negative longitude) to far right (positive
longitude) and spaced in even 10 degree steps in latitude.
</p>
<center>
   <img src="http://paulbourke.net/miscellaneous/Waldram/lines.png" width=800 height=405 border=0>
</center><p>

<p align="justify">
For reference, the following are the left, right and top faces of the cube render
unfolded to lie flat.
</p>
<center>
	<a href="http://paulbourke.net/miscellaneous/Waldram/cube.png">
   <img src="http://paulbourke.net/miscellaneous/Waldram/cube_s.png" width=800 height=800 border=0>
	</a>
</center><p>
</td></tr></table></center>
</body>
</html>

