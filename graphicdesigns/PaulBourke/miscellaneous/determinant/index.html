<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>Determinant of a square matrix</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>



<center><table width=800><tr><td>

<center>
<h1>Determinant of a Square Matrix</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
June 2001
</center>
<br><br>

The determinant of an n by n  matrix will be written as follows<br>
<center>
<table><tr><td>det(A) = |A| = </td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>11</sub></td>
<td>a<sub>12</sub></td>
<td>a<sub>13</sub></td>
<td>. . .</td>
<td>a<sub>1n</sub></td>
</tr>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>22</sub></td>
<td>a<sub>23</sub></td>
<td>. . .</td>
<td>a<sub>2n</sub></td>
</tr>
<tr>
<td>a<sub>31</sub></td>
<td>a<sub>32</sub></td>
<td>a<sub>33</sub></td>
<td>. . .</td>
<td>a<sub>3n</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>a<sub>ij</sub></td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n1</sub></td>
<td>a<sub>n2</sub></td>
<td>a<sub>n3</sub></td>
<td>. . .</td>
<td>a<sub>nn</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td></tr></table>
</center><p>

<p align="justify">
The solution is given by the so called "determinant expansion by minors".
A minor M<sub>ij</sub> of the matrix A is the n-1 by n-1 matrix made by
the rows and columns of A except the i'th row and the j'th column
is not included.
So for example M<sub>12</sub> for the matrix A above is given below
</p>
<center>
<table><tr><td>M<sub>12</sub> = </td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>23</sub></td>
<td>a<sub>24</sub></td>
<td>. . .</td>
<td>a<sub>2n</sub></td>
</tr>
<tr>
<td>a<sub>31</sub></td>
<td>a<sub>33</sub></td>
<td>a<sub>34</sub></td>
<td>. . .</td>
<td>a<sub>3n</sub></td>
</tr>
<tr>
<td>a<sub>41</sub></td>
<td>a<sub>43</sub></td>
<td>a<sub>44</sub></td>
<td>. . .</td>
<td>a<sub>4n</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>a<sub>ij, i!=1, j!=2</sub></td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n1</sub></td>
<td>a<sub>n3</sub></td>
<td>a<sub>n4</sub></td>
<td>. . .</td>
<td>a<sub>nn</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td></tr></table>
</center><p>

<p align="justify">
The determinant is the given by the following where the sum
is taken over a single row or column.
</p>
<center>
<table border=0 cellpadding=4 cellspacing=0><tr>
<td>|A| = </td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/sum.gif" width=39 height=42></td>
<td>(-1)<sup>i+j</sup><td>
<td>a<sub>ij</sub></td>
<td>M<sub>ij</sub></td>
</tr></table>
</center><p>

<p align="justify">
Any row or column can be chosen across which to take the
sum, when computing manually
the row or column with the most zeros is chosen to minimise
the amount of work.
If the first row is chosen for the sum
then the determinant in terms of the minors would be
</p>

<center>
|A| = a<sub>11</sub> M<sub>11</sub> -
      a<sub>12</sub> M<sub>12</sub> +
      a<sub>13</sub> M<sub>13</sub> -
      . . . + a<sub>1n</sub> M<sub>1n</sub>
</center>

Or expanded out as follows.<br>
<center>
<table><tr>
<td>|A| = a<sub>11</sub></td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>22</sub></td>
<td>a<sub>23</sub></td>
<td>a<sub>24</sub></td>
<td>. . .</td>
<td>a<sub>2n</sub></td>
</tr>
<tr>
<td>a<sub>32</sub></td>
<td>a<sub>33</sub></td>
<td>a<sub>34</sub></td>
<td>. . .</td>
<td>a<sub>3n</sub></td>
</tr>
<tr>
<td>a<sub>42</sub></td>
<td>a<sub>43</sub></td>
<td>a<sub>44</sub></td>
<td>. . .</td>
<td>a<sub>4n</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>. . .</td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n2</sub></td>
<td>a<sub>n3</sub></td>
<td>a<sub>n4</sub></td>
<td>. . .</td>
<td>a<sub>nn</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td>

<td>- a<sub>12</sub></td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>23</sub></td>
<td>a<sub>24</sub></td>
<td>. . .</td>
<td>a<sub>2n</sub></td>
</tr>
<tr>
<td>a<sub>31</sub></td>
<td>a<sub>33</sub></td>
<td>a<sub>34</sub></td>
<td>. . .</td>
<td>a<sub>3n</sub></td>
</tr>
<tr>
<td>a<sub>41</sub></td>
<td>a<sub>43</sub></td>
<td>a<sub>44</sub></td>
<td>. . .</td>
<td>a<sub>4n</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>. . .</td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n1</sub></td>
<td>a<sub>n3</sub></td>
<td>a<sub>n4</sub></td>
<td>. . .</td>
<td>a<sub>nn</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td>

<td>+ a<sub>13</sub></td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>22</sub></td>
<td>a<sub>24</sub></td>
<td>. . .</td>
<td>a<sub>2n</sub></td>
</tr>
<tr>
<td>a<sub>31</sub></td>
<td>a<sub>32</sub></td>
<td>a<sub>34</sub></td>
<td>. . .</td>
<td>a<sub>3n</sub></td>
</tr>
<tr>
<td>a<sub>41</sub></td>
<td>a<sub>42</sub></td>
<td>a<sub>44</sub></td>
<td>. . .</td>
<td>a<sub>4n</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>. . .</td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n1</sub></td>
<td>a<sub>n2</sub></td>
<td>a<sub>n4</sub></td>
<td>. . .</td>
<td>a<sub>nn</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td>

</tr></table>
</center><p>

<center>
<table><tr><td>. . . . . + a<sub>1n</sub></td>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>22</sub></td>
<td>a<sub>23</sub></td>
<td>. . .</td>
<td>a<sub>2(n-1)</sub></td>
</tr>
<tr>
<td>a<sub>31</sub></td>
<td>a<sub>32</sub></td>
<td>a<sub>33</sub></td>
<td>. . .</td>
<td>a<sub>3(n-1)</sub></td>
</tr>
<tr>
<td>a<sub>41</sub></td>
<td>a<sub>42</sub></td>
<td>a<sub>43</sub></td>
<td>. . .</td>
<td>a<sub>4(n-1)</sub></td>
</tr>
<tr>
<td>:</td>
<td>:</td>
<td>:</td>
<td>. . .</td>
<td>:</td>
</tr>
<tr>
<td>a<sub>n1</sub></td>
<td>a<sub>n2</sub></td>
<td>a<sub>n3</sub></td>
<td>. . .</td>
<td>a<sub>n(n-1)</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=120></td></tr></table>
</center><p>

<p align="justify">
The process is repeated for each of the determinants above,
on each expansion the dimension of the determinant in each term decreases
by 1. When the terms are 2 by 2 matrices the determinant is given as
</p>

<center>
<table><tr>
<td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=40></td><td>
<table border=0 cellpadding=4 cellspacing=0>
<tr>
<td>a<sub>11</sub></td>
<td>a<sub>12</sub></td>
</tr>
<tr>
<td>a<sub>21</sub></td>
<td>a<sub>22</sub></td>
</tr>
</table>
</td><td><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=40></td>
<td> = </td>
<td>a<sub>11</sub> a<sub>22</sub></td>
<td> - </td>
<td>a<sub>12</sub> a<sub>21</sub></td>
</tr></table>
</center><p>

<p align="justify">
If the determinant is 0 the matrix said to be "singular".
A singular matrix either has zero elements in an entire row or column,
or else a row (or column) is a linear combination of other rows
(or columns).
</p>

<b>C source code example</b>
<pre>
/*
   Recursive definition of determinate using expansion by minors.
*/
double Determinant(double **a,int n)
{
   int i,j,j1,j2;
   double det = 0;
   double **m = NULL;

   if (n &lt; 1) { /* Error */

   } else if (n == 1) { /* Shouldn't get used */
      det = a[0][0];
   } else if (n == 2) {
      det = a[0][0] * a[1][1] - a[1][0] * a[0][1];
   } else {
      det = 0;
      for (j1=0;j1&lt;n;j1++) {
         m = malloc((n-1)*sizeof(double *));
         for (i=0;i&lt;n-1;i++)
            m[i] = malloc((n-1)*sizeof(double));
         for (i=1;i&lt;n;i++) {
            j2 = 0;
            for (j=0;j&lt;n;j++) {
               if (j == j1)
                  continue;
               m[i-1][j2] = a[i][j];
               j2++;
            }
         }
         det += pow(-1.0,1.0+j1+1.0) * a[0][j1] * Determinant(m,n-1);
         for (i=0;i&lt;n-1;i++)
            free(m[i]);
         free(m);
      }
   }
   return(det);
}
</pre>

Contribution by Edward Popko, a well commented version: 
<a href="http://paulbourke.net/miscellaneous/determinant/determinant.c">determinant.c</a> for
Microsoft C++ Visual Studio 6.0.
<p>

<p><br><br><br><p>

<center>
<h1>Inverse of a square matrix</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
August 2002<p>
See also: <a href="index.html">Determinant of a Square Matrix</a>
</center>
<br><br>

<p align="justify">
The inverse of a square matrix A with a non zero determinant is
the adjoint matrix divided by the determinant, this can be written as
</p>
<center>
<table cellspacing=0 cellpadding=0 border=0>
<tr>
<td>&nbsp;</td>
<td><center>1</center></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>A<sup>-1</sup> = </td>
<td><center><img src="http://paulbourke.net/miscellaneous/determinant/hline.gif" width=40 height=3</center></td>
<td>&nbsp;adj(A)</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><center>det(A)</center></td>
<td>&nbsp;</td>
</tr>
</table>
</center>

<p align="justify">
The adjoint matrix is the transpose of the cofactor matrix. The cofactor
matrix is the matrix of determinants of the minors A<sub>ij</sub>
multiplied by -1<sup>i+j</sup>. The i,j'th minor of A is the
matrix A without the i'th column or the j'th row.
</p>

<b>Example (3x3 matrix)</b><br>
<p align="justify">
The following example illustrates each matrix type and at 3x3 the
steps can be readily calculated on paper. It can also be verified that
the original matrix A multiplied by its inverse gives the identity
matrix (all zeros except along the diagonal which are ones).
</p>
<center><table><tr><td align="right">

<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center">A = </td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=45></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
</tr>
</table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=45></td>
</tr></table>
<p>
Determinant = 9
<p>



<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center">Cofactor matrix = </td>
<td valign="center">&nbsp;<img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=150>&nbsp;</td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0><tr>
<td><center>&nbsp;&nbsp;
	<table cellpadding=0 cellspacing=0 border=0><tr>
	<td valign="center">&nbsp;&nbsp;+ </td>
	<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
	<td valign="center">
	<table cellpadding=0 cellspacing=0 border=0><tr>
	<td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
	<td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
	</tr><tr>
	<td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
	<td><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
	</tr></table></td>
	<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
	</tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;- </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;+ </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
</tr><tr>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;- </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;+ </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;- </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
</tr><tr>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;+ </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;- </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
<td><center>&nbsp;&nbsp;
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td valign="center">&nbsp;&nbsp;+ </td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   <td valign="center">
   <table cellpadding=0 cellspacing=0 border=0><tr>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
   </tr><tr>
   <td><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
   <td><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
   </tr></table></td>
   <td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/line.gif" width=3 height=26></td>
   </tr></table>
&nbsp;&nbsp;</center></td>
</tr></table></td>
<td valign="center">&nbsp;&nbsp;<img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=150>&nbsp;&nbsp;</td>
<td valign="center">&nbsp;&nbsp;=&nbsp;&nbsp;</td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=45></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0><tr>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;4&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-3&nbsp;&nbsp;</center></td>
</tr><tr>
<td height=10><center>&nbsp;&nbsp;-6&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-0&nbsp;&nbsp;</center></td>
</tr><tr>
<td height=10><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
</tr></table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=45></td>
</tr></table>
<p>
<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center">Adjoint matrix = Transpose of cofactor matrix = </td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=45></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-6&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;2&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;4&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-1&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;-3&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3&nbsp;&nbsp;</center></td>
</tr>
</table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=45></td>
</tr></table>
<p>
<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center">A<sup>-1</sup> = Inverse of A = </td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=45></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td height=10><center>&nbsp;&nbsp;1/9&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-6/9&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;2/9&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;4/9&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3/9&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-1/9&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;-3/9&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;3/9&nbsp;&nbsp;</center></td>
</tr>
</table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=45></td>
</tr></table>
<p>
<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center">A A<sup>-1</sup> = </td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=45></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
</tr>
<tr>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;0&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;1&nbsp;&nbsp;</center></td>
</tr>
</table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=45></td>
</tr></table>
</td></tr></table></center><p>

<b>Inverse of a 2x2 matrix</b><br>
<p align="justify">
The inverse of a 2x2 matrix can be written explicitly, namely
</p>
<center>
<table cellspacing=0 cellpadding=0 border=0><tr>
<td>
<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=30></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0><tr>
<td height=10><center>&nbsp;&nbsp;a&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;b&nbsp;&nbsp;</center></td>
</tr><tr>
<td height=10><center>&nbsp;&nbsp;c&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;d&nbsp;&nbsp;</center></td>
</tr></table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=30></td>
</tr></table>
</td>

<td>&nbsp;=&nbsp;</td>

<td>
<table cellpadding=0 cellspacing=0 border=0>
<tr><td><center>1</center></td></tr>
<tr><td><center>
&nbsp;<img src="http://paulbourke.net/miscellaneous/determinant/hline.gif" width=40 height=3>&nbsp;</center></td></tr>
<tr><td><center>ad - bc</center></td></tr>
</table>
</td>

<td>
<table cellpadding=0 cellspacing=0 border=0><tr>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/lbracket.gif" width=3 height=30></td>
<td valign="center">
<table cellpadding=0 cellspacing=0 border=0><tr>
<td height=10><center>&nbsp;&nbsp;d&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;-b&nbsp;&nbsp;</center></td>
</tr><tr>
<td height=10><center>&nbsp;&nbsp;-c&nbsp;&nbsp;</center></td>
<td height=10><center>&nbsp;&nbsp;a&nbsp;&nbsp;</center></td>
</tr></table></td>
<td valign="center"><img src="http://paulbourke.net/miscellaneous/determinant/rbracket.gif" width=3 height=30></td>
</tr></table>
</td>

</tr></table>
</center>

<b>Source code</b><p>
The three functions required are the determinant, cofactor, and
transpose. Examples of these are given below.
<pre>
/*
   Recursive definition of determinate using expansion by minors.
*/
double Determinant(double **a,int n)
{
   int i,j,j1,j2;
   double det = 0;
   double **m = NULL;

   if (n &lt; 1) { /* Error */

   } else if (n == 1) { /* Shouldn't get used */
      det = a[0][0];
   } else if (n == 2) {
      det = a[0][0] * a[1][1] - a[1][0] * a[0][1];
   } else {
      det = 0;
      for (j1=0;j1&lt;n;j1++) {
         m = malloc((n-1)*sizeof(double *));
         for (i=0;i&lt;n-1;i++)
            m[i] = malloc((n-1)*sizeof(double));
         for (i=1;i&lt;n;i++) {
            j2 = 0;
            for (j=0;j&lt;n;j++) {
               if (j == j1)
                  continue;
               m[i-1][j2] = a[i][j];
               j2++;
            }
         }
         det += pow(-1.0,j1+2.0) * a[0][j1] * Determinant(m,n-1);
         for (i=0;i&lt;n-1;i++)
            free(m[i]);
         free(m);
      }
   }
   return(det);
}

/*
   Find the cofactor matrix of a square matrix
*/
void CoFactor(double **a,int n,double **b)
{
   int i,j,ii,jj,i1,j1;
   double det;
   double **c;

   c = malloc((n-1)*sizeof(double *));
   for (i=0;i&lt;n-1;i++)
     c[i] = malloc((n-1)*sizeof(double));

   for (j=0;j&lt;n;j++) {
      for (i=0;i&lt;n;i++) {

         /* Form the adjoint a_ij */
         i1 = 0;
         for (ii=0;ii&lt;n;ii++) {
            if (ii == i)
               continue;
            j1 = 0;
            for (jj=0;jj&lt;n;jj++) {
               if (jj == j)
                  continue;
               c[i1][j1] = a[ii][jj];
               j1++;
            }
            i1++;
         }

         /* Calculate the determinate */
         det = Determinant(c,n-1);

         /* Fill in the elements of the cofactor */
         b[i][j] = pow(-1.0,i+j+2.0) * det;
      }
   }
   for (i=0;i&lt;n-1;i++)
      free(c[i]);
   free(c);
}

/*
   Transpose of a square matrix, do it in place
*/
void Transpose(double **a,int n)
{
   int i,j;
   double tmp;

   for (i=1;i&lt;n;i++) {
      for (j=0;j&lt;i;j++) {
         tmp = a[i][j];
         a[i][j] = a[j][i];
         a[j][i] = tmp;
      }
   }
}
</pre>

</td></tr></table></center>
</body>
</html>

