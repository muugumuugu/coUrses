<html>
<head>
<link rel=StyleSheet href="../../pdbstyle.css" type="text/css" media=all>
<title>Of spherical nature</title>
</head>
<body>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script language="JavaScript">
<!--
   if (self.location.href != top.location.href) {
      top.location.href = self.location.href;
   }
-->
</script>


<center><table width=800><tr><td>

<center>
<h1>Geometry of sports balls</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
January 2017<p>
</center>
<p><br><p>

<p align="justify">
In what follows various mathematical and graphical models will be presented for the surface features
of some popular sports balls. In each case the equirectangular texture will be
provided along with a couple of rendered images. The intent here is not to
present high quality and realistic renderings, but rather to capture the underlying
geometric essence. It should be noted that in many cases there is not one design for the balls,
there is variation over the years as manufacturing has evolved but also variations due
to different manufactures, in some case variations arising due to patents.
</p>



<br><br><br><b>Tennis ball</b> (Softball, Baseball, Basketball, Tee ball, Hurling)<p>
<p align="justify">
The shape of the seam on a tennis ball, like some other ball seams, arises from the
initial goal of producing one 2D shape that can be cut out of a sheet of material and then
stitched together in pairs. This is an example of <a href="../dform/index.html">dform surfaces</a>.
One proposed equation for the the seam is the following parametric equation
</p>
<center>
x = sin(pi/2 - (pi/2 - A) cos(T)) cos(T/2 + A sin(2T))<br>
y = sin(pi/2 - (pi/2 - A) cos(T)) sin(T/2 + A sin(2T))<br>
z = cos(pi/2 - (pi/2 - A) cos(T))
</center><p>
Where T ranges from 0 to 4pi and parameter A in the following is 0.44.
<p>
<center>
	<a href="tennis_sph.png"><img src="tennis_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
	<img src="tennis1.png" width=400 height=400 border=0>
</td><td>
	<img src="tennis2.png" width=400 height=400 border=0>
</td></tr></table></center><p>
<p align="justify">
Another construction involves constructive solid geometry, namely the subtraction
of a cylinder and box from a sphere.
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="tenniscsg1.png" width=400 height=400 border=0><br>
	<center>
   <font size=-1>CSG elements: sphere, cylinder, box</font>
	</center>
</td><td>
   <img src="tenniscsg2.png" width=400 height=400 border=0><br>
	<center>
   <font size=-1>One half of ball, other half involved two rotations</font>
	</center>
</td></tr></table></center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="tenniscsg3.png" width=400 height=400 border=0>
</td><td>
   <img src="tenniscsg4.png" width=400 height=400 border=0>
</td></tr></table></center><p>
<p align="justify">
Equirectangular projection of one half of ball, the other half is the same form rotated 180
degrees about the vertical axis and then 90 degrees along the gap axis.
</p>
<center>
   <a href="tenniscsg_sph.png"><img src="tenniscsg_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<p align="justify">
The relative size of the lobes is controlled by the relative size of the
subtracted cylinder and box.
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="tenniscsg5.png" width=400 height=400 border=0><br>
	<center>
	<font size=-1>Subtracted cylinder of radius 0.7</font>
	</center>
</td><td>
   <img src="tenniscsg6.png" width=400 height=400 border=0><br>
	<center>
	<font size=-1>Subtracted cylinder of radius 0.5</font>
	</center>
</td></tr></table></center><p>
<p align="justify">
Another formation with good control over the seam spacing is to take the intersection of
an <a href="../ennepers/index.html">Ennepers</a> minimal
surface with a sphere, the radius of the sphere controlling how close the
lobes are.<br>
Parametric equations for the Ennepers surface is
</p>
<center>
x = u - u<sup>3</sup> / 3 + u v<sup>2</sup><br>
y = v - v<sup>3</sup> / 3 + v u<sup>2</sup><br>
z = u<sup>2</sup> - v<sup>2</sup><br>
</center><p>
Where, in the figure below, -2 <= u <= 2, -2 <= v <= 2
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="tennisenn1.png" width=400 height=400 border=0><br>
   <center>
   <font size=-1>Ennepers minimal surface</font>
   </center>
</td><td>
   <img src="tennisenn2.png" width=400 height=400 border=0><br>
   <center>
   <font size=-1>Intersection with sphere of radius 0.5</font>
   </center>
</td></tr></table></center><p>
<center>
   <a href="tennisenn_sph.png"><img src="tennisenn_sph_s.png" width=800 height=400 border=1></a>
</center><p>



<br><br><br><b>Basketball</b> (Water basketball)<p>
<p align="justify">
The main curved seam on a basketball can be created using the same techniques as 
for the tennis ball, it has an additional two seams at 90 degrees to each other.
</p>
<center>
   <a href="basketball_sph.png"><img src="basketball_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="basketball1.png" width=400 height=400 border=0>
</td><td>
   <img src="basketball2.png" width=400 height=400 border=0>
</td></tr></table></center><p>



<br><br><br><b>Cricket ball</b><p>
<p align="justify">
This is a rather dull case since a cricket ball only has a single seam between two
hemispheres, dark line in the equirectangular below. The other curves represent the 
stitching which runs along lines of latitude on either side of the seam.
</p>
<center>
   <a href="cricket_sph.png"><img src="cricket_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="cricket1.png" width=400 height=400 border=0>
</td><td>
   <img src="cricket2.png" width=400 height=400 border=0>
</td></tr></table></center><p>



<br><br><br><b>Soccer ball</b> (Hand ball)<p>
<p align="justify">
A soccer ball seam is the projection of a <a href="../polyhedra/index.html">truncated icosahedron</a>
(see item 22 and 25) onto the surface of a sphere.
There are 60 vertices, 90 seam edges, 20 regular hexagonal faces and
12 regular pentagonal faces. The  truncated icosahedron is
constructed by starting with an icosahedron with the 12 vertices truncated 1/3 of the 
distance. This creates 12 additional pentagon faces, and turns the original 20 triangular
faces into regular hexagons. 
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="polyhedra22.jpg" width=400 height=400 border=0><br>
	<center><font size=-1>Icosahedron</font></center>
</td><td>
   <img src="polyhedra25.jpg" width=400 height=400 border=0><br>
	<center><font size=-1>Truncated Icosahedron</font></center>
</td></tr></table></center><p>
<center>
   <a href="soccer_sph.png"><img src="soccer_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="soccer1.png" width=400 height=400 border=0>
</td><td>
   <img src="soccer2.png" width=400 height=400 border=0>
</td></tr></table></center><p>
<p align="justify">
The map can be rotated to place the two hexagons at the poles making the equirectangular
projection easier to understand.
</p>
<center>
   <a href="soccer2_sph.png"><img src="soccer2_sph_s.png" width=800 height=400 border=1></a>
</center><p>




<br><br><br><b>Golf ball</b><p>
<p align="justify">
The roughness of a golf ball, introduced in the late 1800's, made 
for a more consistent flight path than smooth surfaces. The dimples, 
introduced in the early 1900's, create a turbulent layer around the 
ball creating a low pressure leading edge and thus less drag allowing 
the ball to travel further. There were disputes in the 1980's around 
symmetric vs non-symmetric dimple patterns, the later provided for a 
sort of self correction of ball spin during flight. While there are 
asymmetric balls they are only allowed in non-tournament games. 
Most balls have between 300 and 500 dimples. The example below has 308 dimples.
It is formed by progressively sampling lines of latitude in equal steps
with ever increasing steps in longitude and phase offsets per latitude.
</p>
<center>
   <a href="golf_sph.png"><img src="golf_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="golf1.png" width=400 height=400 border=0>
</td><td>
   <img src="golf2.png" width=400 height=400 border=0>
</td></tr></table></center><p>

<p align="justify">
But this doesn't give the local hexagonal neighbourhood around each dimple,
see the example on the right above. A more regular dimple pattern can be achieved by starting with an
icosahedron and tiling each triangular face with a regular triangular array
of dimples.
</p>
<center>
   <a href="golf2_sph.png"><img src="golf2_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="golf21.png" width=400 height=400 border=0><br>
	<center><font size=-1>362 dimples showing icosahedral faces</font></center>
</td><td>
   <img src="golf22.png" width=400 height=400 border=0><br>
	<center><font size=-1>362 dimples</font></center>
</td></tr></table></center><p>

<center>
   <a href="golf3_sph.png"><img src="golf3_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="golf31.png" width=400 height=400 border=0><br>
   <center>492 dimples showing icosahedral faces</center>
</td><td> 
   <img src="golf32.png" width=400 height=400 border=0><br>
   <center>492 dimples</center>
</td></tr></table></center><p>

<p align="justify">
The next approach is to perform a minimisation process to distribute points on
a sphere. This may be an arbitrary simulation or a spring system as described
<a href="../circlesphere/index.html">here</a>.
The following example has 500 dimples and unlike the previous methods where only
certain densities can be supported, this approach can be applied to any number of dimples.
</p>
<center>
   <a href="golf4_sph.png"><img src="golf4_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="golf41.png" width=400 height=400 border=0><br>
</td><td>
   <img src="golf42.png" width=400 height=400 border=0><br>
</td></tr></table></center><p>




<br><br><br><b>Rugby ball</b> (Australia rules football)<p>
<p align="justify">
While the early rugby balls were shaped more like the 
<a href="index.html#american">American footballs</a>, the
current rugby ball is a prolate spheroid with a major to minor axis ratio of about 1.5.
Besides a sphere stretched along one axis there are many other ways of describing
this shape, one example being a super-ellipsoid.
</p>
<center>
   <a href="rugby_sph.png"><img src="rugby_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="rugby1.png" width=400 height=400 border=0>
</td><td>
   <img src="rugby2.png" width=400 height=400 border=0>
</td></tr></table></center><p>



<br><br><br><a name="american"><b>American football</b> (Gridiron)</a><p>
<p align="justify">
The ball shape can be represented as the intersection of two off-center circles,
rotated about the mirror axis. The design is intended to reduce drag when thrown
with a rotation along the long axis.<br>
Specifically, the formulation employed here for each arc section is
</p>
<center>
(x + r)<sup>2</sup> + y<sup>2</sup> = R<sup>2</sup><br>
and
(x - r)<sup>2</sup> + y<sup>2</sup> = R<sup>2</sup><br>
</center><p>
<p align="justify">
where the range for x is 0 to R-r
and the range for y is -sqrt(R<sup>2</sup> - r<sup>2</sup>) to 
sqrt(R<sup>2</sup> - r<sup>2</sup>).
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="football1.png" width=400 height=400 border=0><br>
	&nbsp;
</td><td>
   <img src="football2.png" width=400 height=400 border=0><br>
	<center>r = 0.6, R = 1</center>
</td></tr></table></center><p>
<p align="justify">
The seams are the same as for the rugby football, namely, 4 lines of longitude
spaced every 90 degrees about the long axis of the ball. As with most ball seams
they arise from the desire
to create the ball skin from a number of equal shaped and sized pieces.
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="football3.png" width=400 height=400 border=0><br>
   <center>r = 0.4, R = 1</center>
</td><td>
   <img src="football4.png" width=400 height=400 border=0><br>
   <center>r = 0.3, R = 1</center>
</td></tr></table></center><p>

<br><br><br><b>Volley ball</b> (Gaelic football, Water polo, Netball)<p>
<p align="justify">
There are a few variation of the design of volley balls, the simplest to describe 
geometrically is presented below. One takes a cube and splits each face into three sections.
The axis of the sections is the same for opposing faces of the cube, but along a different
axis for each pair of opposing faces. These lines are then projected onto the surface
of a sphere.
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="volley3.png" width=400 height=400 border=0><br>
	<center><font size=-1>Cube construction</font></center>
</td><td>
   <img src="volley4.png" width=400 height=400 border=0><br>
	<center><font size=-1>Inflated to unit sphere</font></center>
</td></tr></table></center><p>
<center>
   <a href="volley_sph.png"><img src="volley_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="volley1.png" width=400 height=400 border=0>
</td><td>
   <img src="volley2.png" width=400 height=400 border=0>
</td></tr></table></center><p>

<br><br><br><b>Boules</b> (Bocce)<p>
<p align="justify">
There are a wide range of designs but they are generally 
symmetric slices by a number of planes through
a sphere, repeated on two or three axes.
</p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="boules1.png" width=400 height=400 border=0><br>
</td><td>
   <img src="boules2.png" width=400 height=400 border=0><br>
</td></tr></table></center><p>
<center>
   <a href="boules_sph.png"><img src="boules_sph_s.png" width=800 height=400 border=1></a>
</center><p>
<center><table cellspacing=0 cellpadding=0 border=0><tr><td>
   <img src="boules3.png" width=400 height=400 border=0>
</td><td>
   <img src="boules4.png" width=400 height=400 border=0>
</td></tr></table></center><p>

<br><br><br><b>Others</b><p>
<p align="justify">
There are a number of other sports balls not included here, largely because they are
not interesting.
</p>
<p align="justify">
Squash balls are simple spheres with only one or two small dots to indicate hardness (bounce).
</p>
<p align="justify">
Similarly, ten pin bowling balls only have three finger grip holes.
</p>
<p align="justify">
Pool, snooker and billiards balls may include dots (billiards) or numbers and simple
bands of colour.
</p>
<p align="justify">
Ping pong balls have no markings at all. Same for croquet balls, racket-ball,
and polo (horseback).
</p>

<br><br>

<center>
<h1>Prolate-spheroid and Cymbelloid</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
September 2002
</center>
<p>

The points on an ellipsoid (3 dimensions) satisfy the equation<br>
<center>(x/a)<sup>2</sup> + (y/b)<sup>2</sup> + (z/c)<sup>2</sup> = 1</center>
<p>
Or in polar coordinates<br>
<center><table><tr><td>
x = a cos(theta) cos(phi)<br>
y = b cos(theta) sin(phi)<br>
z = c sin(phi)<br>
where -pi <= phi <= phi<br>
and 0 <= theta <= 2 pi
</td></tr></table></center>
<p>
The special case where a = b is called a prolate-spheroid, it is a sphere
with a stretch (scale factor > 1, not compression, c > a)
along one axis. The equation can be written as<br>
<center>((x + y)/a)<sup>2</sup> + (z/c)<sup>2</sup> = 1</center>
<p>
Where a is the equatorial radius and c the polar radius.
<p>
The example below illustrates a prolatespheroid where c = 1.5 a<br>
<center><img src="prolate1.gif" width=680 height=322></center>
<p>
The degree of stretching is often called the eccentricity in 2 dimensions
or the ellipticity in 3 dimensions, it is defined by<br>
<center>e = sqrt(1 - (a/c)<sup>2</sup>)</center>
<p>
e is 0 for a sphere (a = c), and e approaches 1 as the prolate-spheroid
become increasingly elongated.
<p>
The surface area is<br>
<center>
2 pi a [ a + (c/e) arcsin(e) ]
</center>
<p>
The volume is<br>
<center>
4 pi c a<sup>2</sup> / 3
</center>
<p>

<table width=100%><tr><td valign="top">
<a name="cymbelloid">
<b>Cymbelloid</b></a><p>
The Cymbelloid is a slice of a prolate-spheroid.<p>

Given the dimensions of the Cymbelloid on the right,
the volume is given by<br>
<center>
4 c a<sup>2</sup> arcsin(D/2a) / 3
</center>
<br>or<br>
<center>
4 c a d / 6
</center>
<p>

The surface area is <br>
<center>
d [ a + (c/e) arcsin(e) ]
</center>
<br>or<br>
<center>
2 a arcsin(D/2a) [ a + (c/e) arcsin(e) ]
</center>
<p>

<img src="cymbelloid1.gif" width=251 height=312><p>
</td><td valign="top">
<img src="cymbelloid2.gif" width=225 height=505><p>
</td></tr></table>

<br><br>


<center>
<h1>Super-ellipse and Super-ellipsoid</h1>
<h3>A Geometric Primitive for Computer Aided Design</h3>
Written by <a href="../index.html">Paul Bourke</a><br>
January 1990<p>
See also Super-toroid, <a href="superellipse.tar.gz">Radiance examples</a>.
</center>

<p>

This is a description of a proposed primitive for computer aided design. In 2
dimensions it includes the circle and ellipse, in 3 dimensions it has the
sphere and ellipsoid as special cases. By varying its parameters it can form a
continuum of other shapes.

<b>2 dimensions - super-ellipse</b><p>

In 2 dimensions the super-ellipse centered at the origin is defined in
parametric form as

<p><center><IMG SRC="superellipse1.gif" width=101 height=72></center><p>

The curve intersects the x axis at rx and -rx, it intersects the y axis at ry
and -ry, ie: the super-ellipse is enclosed in a rectangle of width 2rx and
height 2ry.<p>
This is the form most easily employed to draw a super-ellipse, the angle
&oslash; is varied from 0 to 2pi in suitably small steps, a line is drawn to
each subsequent value of &oslash;.

<p><center><IMG SRC="superellipse2.gif" width=297 height=157></center><p>

Forming the curve using the parametric form above and uniformly varying the
angle automatically samples the curve with curvature dependent sampling. That
is, there are more samples where the curve is changing rapidly, a desirable
characteristic.<br>
We can also write

<p><center><IMG SRC="superellipse3.gif" width=157 height=30></center><p>

then <br>
if f(x,y) equals 1, (x,y) lies on the super-ellipse boundary<br>
if f(x,y) is less than 1, (x,y) lies on the interior of the super-ellipse<br>
if f(x,y) is greater than 1, (x,y) lies on the outside of the super-ellipse]<p>

The above can be used to form the super-ellipse (although it must be done in
quadrants). Solving for y gives

<p><center><IMG SRC="superellipse4.gif" width=137 height=37></center><p>

Varying n controls the form of the super-ellipse, some special cases are
outlined below

<p><center><IMG SRC="superellipse5.gif" width=343 height=169></center><p>

Pictorially

<p><center><IMG SRC="superellipse6.gif" width=541 height=118></center><p>

Note that the super-ellipse always passes through the same points at &oslash; =
0, pi/2, pi, 3pi/2 and so it is possible to have different values of n in each
quadrant.
<p>

<b>3 dimensions - super-ellipsoid</b><p>

The super-ellipse is name given to a family of shapes formed from
the spherical product of two superquadratric curves. These shapes
can be used to model a wide range of shapes including spheres, cylinders,
and parallelepipeds as well as shapes in between.
<p>

In 3 dimensions the super-ellipse centered at the origin is defined 
as follows<p>

<center><IMG SRC="superellipse7.gif" width=164 height=98></center><p>

As for the two dimensional case rx, ry, and rz are the scale factors for each
axis (axis intercept). The total shape lies at the centre of a box of dimension
2rx, 2ry, 2rz. The power n1 acts as the "squareness" parameter in the z axis
and n2 the squareness in the x-y plane.<p>

Some special cases of parameter n1 and n2

<p><center><IMG SRC="superellipse8.gif" width=391 height=224></center><p>

The super-ellipse can also be written as 

<p><center><IMG SRC="superellipse9.gif" width=293 height=37></center><p>

where the same relationships as for the 2D case (super-ellipse) can be made,
namely<br>
if f(x,y,z) equals 1, (x,y,z) lies on the super-ellipsoid surface<br>
if (f(x,y,z) is less than 1, (x,y,z) lies on the interior the super-ellipsoid <br>
if (f(x,y,z) is greater than 1, (x,y,z) lies on the outside of the super-ellipsoid <p>

Closed expressions can be derived for the normal at any point on the
super-ellipsoid making many rendering calculations with lighting models easier.
The normal is given by

<p><center><IMG SRC="superellipse10.gif" width=207 height=85></center><p>

Interestingly, if n1 and n2 are less than 2 then the equation of the normal of
the super-ellipsoid is another super-ellipsoid (its dual) with n1 -&gt; 2 - n1,
and n2 -&gt; 2 - n2. For example, the normals of a super-ellipsoid with n1=0.5
and n2=0.2 is another super-ellipsoid (suitably scaled) with n1=1.5 and n2=1.8.

<p><center><IMG SRC="superellipse11.gif" width=600 height=600></center>
<p>

<b>Bibliography</b><p>
<i>
Barr, A.H.</i>, Superquadrics and Angle Preserving Transformations. IEEE
Computer Graphics and Applications, January 1981.<p>
<i>
Faux, I.D., and Pratt, M.J.</i>, Computational Geometry for Design and
Manufacture. Ellis Horwood Ltd., Wiley &amp; Sons, 1979.<i><p>
Wallace, A.</i>, Differential Topology, Benjamin/Cummings Co., Reading , Mass,
USA, 1968.

<p><br><br><br><p>

<center>
<h1>OpenGL Super-ellipsoid</h1>
<h3>A versatile primitive</h3>
Written by <a href="../index.html">Paul Bourke</a><br>
November 2001<p>
</center>

<p>

<p align="justify">
The super-ellipsoid is a versatile primitive that is controlled by
two parameters. As special cases it can represent a sphere, square box,
and closed cylindrical can. The equations are given below, the powers
n1 and n2 are the two parameters.
</p>

<center>
<img src="equations.gif" width=164 height=98>
</center>

<p align="justify">
It should be noted that there are some numerical issues with both very
small or very large values of these parameters. Typically, for safety,
they should be in the range of 0.1 to about 5.
</p>

<center>
<table>
<tr>
<td><img src="a.png" width=200 height=200></td>
<td>&nbsp</td>
<td>The two parameters = 1</td>
</tr>
<tr>
<td><img src="b.png" width=200 height=200></td>
<td><img src="b1.png" width=200 height=200></td>
<td>First parameter = 1<br>Second parameter large</td>
</tr>
<tr>
<td><img src="c.png" width=200 height=200></td>
<td><img src="c1.png" width=200 height=200></td>
<td>First parameter = small<br>Second parameter large</td> 
</tr>
<tr>
<td><img src="d.png" width=200 height=200></td>
<td><img src="d1.png" width=200 height=200></td>
<td>First parameter = small<br>Second parameter = 1</td> 
</tr>
<tr>
<td><img src="e.png" width=200 height=200></td>
<td><img src="e1.png" width=200 height=200></td>
<td>First parameter = large<br>Second parameter = 1</td> 
</tr>
<tr>
<td><img src="f.png" width=200 height=200></td>
<td><img src="f1.png" width=200 height=200></td>
<td>First parameter = large<br>Second parameter large</td> 
</tr>
</table>
</center>


<p align="justify">
The code below creates a unit superellipsoid at the origin, it
correctly assigns normals and texture coordinates.
</p>

<pre>
/*
   Create a superellipse
   "method" is 0 for quads, 1 for triangles
      (quads look nicer in wireframe mode)/
   This is a "unit" ellipsoid (-1 to 1) at the origin,
      glTranslate() and glScale() as required.
*/
void CreateSuperEllipse(double power1,double power2,int n,int method)
{
   int i,j;
   double theta1,theta2,theta3;
   XYZ p,p1,p2,en;
   double delta;

   /* Shall we just draw a point? */
   if (n &lt; 4) {
      glBegin(GL_POINTS);
      glVertex3f(0.0,0.0,0.0);
      glEnd();
      return;
   }

   /* Shall we just draw a plus */
   if (power1 &gt; 10 && power2 &gt; 10) {
      glBegin(GL_LINES);
      glVertex3f(-1.0, 0.0, 0.0);
      glVertex3f( 1.0, 0.0, 0.0);
      glVertex3f( 0.0,-1.0, 0.0);
      glVertex3f( 0.0, 1.0, 0.0);
      glVertex3f( 0.0, 0.0,-1.0);
      glVertex3f( 0.0, 0.0, 1.0);
      glEnd();
      return;
   }

   delta = 0.01 * TWOPI / n;
   for (j=0;j&lt;n/2;j++) {
      theta1 = j * TWOPI / (double)n - PID2;
      theta2 = (j + 1) * TWOPI / (double)n - PID2;

      if (method == 0)
         glBegin(GL_QUAD_STRIP);
      else
         glBegin(GL_TRIANGLE_STRIP);
      for (i=0;i&lt;=n;i++) {
         if (i == 0 || i == n)
            theta3 = 0;
         else
            theta3 = i * TWOPI / n;

         EvalSuperEllipse(theta2,theta3,power1,power2,&p);
         EvalSuperEllipse(theta2+delta,theta3,power1,power2,&p1);
         EvalSuperEllipse(theta2,theta3+delta,power1,power2,&p2);
         en = CalcNormal(p1,p,p2);
         glNormal3f(en.x,en.y,en.z);
         glTexCoord2f(i/(double)n,2*(j+1)/(double)n);
         glVertex3f(p.x,p.y,p.z);

         EvalSuperEllipse(theta1,theta3,power1,power2,&p);
         EvalSuperEllipse(theta1+delta,theta3,power1,power2,&p1);
         EvalSuperEllipse(theta1,theta3+delta,power1,power2,&p2);
         en = CalcNormal(p1,p,p2);
         glNormal3f(en.x,en.y,en.z);
         glTexCoord2f(i/(double)n,2*j/(double)n);
         glVertex3f(p.x,p.y,p.z);
      }
      glEnd();
   }
}

void EvalSuperEllipse(double t1,double t2,double p1,double p2,XYZ *p)
{
   double tmp;
   double ct1,ct2,st1,st2;

   ct1 = cos(t1);
   ct2 = cos(t2);
   st1 = sin(t1);
   st2 = sin(t2);

   tmp  = SIGN(ct1) * pow(fabs(ct1),p1);
   p-&gt;x = tmp * SIGN(ct2) * pow(fabs(ct2),p2);
   p-&gt;y = SIGN(st1) * pow(fabs(st1),p1);
   p-&gt;z = tmp * SIGN(st2) * pow(fabs(st2),p2);
}
</pre>


<p><br><br><br><p>

<center>
<h1>POVRAY Super-ellipsoids</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
June 1986
</center>
<p>

<p align="justify">
The following grid illustrates the range of super-ellipsoids as
variable "e" and "n" are each varied between 0.2 and 3.
The POVRAY source that generated the image below is given here: 
<a href="super.pov">super.pov</a>.
</p>

<center><img src="super.gif" border=2></center><p>

<p><br><br><br><p>

<center><h1>Super-circle</h1></center>
<p>
<center>
<img src="supercircle1.gif"><p>
<img src="supercircle2.gif"><p>
</center>

<br><br>

<center>
<h1>Generating Capsule Geometry</h1>
Written by <a href="../index.html">Paul Bourke</a><br>
April 2012
</center>
<p><br><p>

<p align="justify">
The following will briefly describe a way of creating an capsule shape, example code
is supplied here: <a href="capsule.c">capsule.c</a> (Tab stops to 3 spaces for correct
indenting).
which created the shape and saves the result
as an obj file with normals and texture coordinates. The code should be easy to modify
to create the mesh geometry in other formats or for APIs such as OpenGL. The output from
the code plus a sample texture map are given below.
</p>

<ul>
<li>The obj file: <a href="capsule.obj.zip">capsule.obj.zip</a><p>
<li>The mtl (material file): <a href="capsule.mtl">capsule.mtl</a><p>
<li>And the jpg texture: <a href="capsule0.jpg">capsule0.jpg</a><p>
</ul><p>

<p align="justify">
It is fairly obvious that the desired shape is just two halves of a sphere
offset along the intended axis of the capsule. Also, that it is not necessary
to explicitly add a central cylinder, rather just join up the equator of each half
sphere. 
</p>
<center><img src="capsule1.png" width=400 height=258 border=0></center><p>

<p align="justify">
The normals are straightforward to calculate, they are just the vectors to the vertices
of the normalised sphere before offsetting along the capsule axis. There are many options
for the texture coordinates, the one chosen here is the projection of a sphere onto the
capsule. These are computed by calculating the longitude and latitude of each vertex of the
capsule and mapping those to (u,v) in the usual way. 
The result given the texture map (spherical projection) given above is shown
below.
</p>

<center><img src="capsule2.png" width=285 height=400 border=0></center><p>

<p align="justify">
Coordinate system conventions.
</p>

<center><img src="capsule3.jpg" width=800 height=791 border=1></center><p>

<br><br>


<center>
<h1>Eggs, melons, and peanuts - Cassini Oval</h1>
Also called: Cassinoid or Cassinian Ellipse<br>
Written by <a href="../index.html">Paul Bourke</a><br>
April 2001
</center>
<p><br><p>

<b>Introduction</b><p>

<p align="justify">
Around 1680 Giovanni Cassini investigated a family of curves which he
believed defined the path the Earth takes around the sun. The curves were
defined by all the points where the <u>product</u> of the distances from the 
point to two fixed points (call the separation 2a) 
were some constant (call this b<sup>2</sup>). 
Note an ellipse is defined as the
points where the <u>sum</u> of the distances to two fixed points equal some
constant. 
</p>

<p align="justify">
The general appearance of the curve
is dictated by the relative values of a and b. If a < b the curve forms
a single loop, this loop becomes increasingly pinched as a approaches b.
When a > b the curve is made up of two loops, at a = b it is the same
as the lemnescate of Bernoulli that was documented about 14 years later.
</p>

<b>Equations</b><p>

<p align="justify">
There are a number of ways to describe the Cassini oval, some of these
are given below.
</p>
Bipolar coordinates<br>
<center>
r<sub>1</sub> r<sub>2</sub> = b<sup>2</sup>
</center>
<p>
Cartesian description from the definition<br>
<center>
[(x - a)<sup>2</sup> + y<sup>2</sup>]
[(x + a)<sup>2</sup> + y<sup>2</sup>] = b<sup>2</sup>
</center>
<br>
or equivalently<br>
<center>
(a<sup>2</sup> + x<sup>2</sup> + y<sup>2</sup>)<sup>2</sup>
- 4 a<sup>2</sup> x<sup>2</sup>
- b<sup>4</sup> = 0
</center>
<br>These clearly revert to a circle of radius b for a = 0.
<p>
Polar coordinates<br>
<center>
r<sup>4</sup> + a<sup>4</sup> - b<sup>4</sup> -
2 a<sup>2</sup> r<sup>2</sup> cos(2theta) = 0
</center><br>
<p align="justify">
It is possible to solve for r<sup>2</sup> using the standard solution
for a quadratic. When using this formulation to create
the curve in 2D or surfaces of revolution to form solids in 3D be 
very careful about the range of theta and what the positive and negative
solutions mean.
</p>

<p align="justify">
The parametric formulation used to create the curves and solids here
is based up the following.
</p>
<center>
x(t) = cos(t) sqrt(C)<br>
y(t) = sin(t) sqrt(C)<br>
where C = a<sup>2</sup> cos(2t) +/- sqrt(b<sup>4</sup> - 
	a<sup>4</sup> sin<sup>2</sup>(2t))
</center>
<p>
Note:<br>
<ul>
<li>Note b cannot be 0
<p>
<li>When a < b the parameter t ranges from 0 to 2pi
<p>
<li>When a = b the curve reduces to r<sup>2</sup> = a<sup>2</sup> cos(2theta)
<p>
<li>When a > b each loop is defined in two parts, one using the positive
version of C above, and the other using the negative version. The parameter
t ranges from -0.5 arcsin(b<sup>2</sup>/a<sup>2</sup>) to
0.5 arcsin(b<sup>2</sup>/a<sup>2</sup>). A similar arrangement occurs 
for the polar formulation described earlier.
</ul>
<p>

<p align="justify">
An unexpected way to create a Cassini curve is to slice a torus with
a plane parallel to the axis of the torus. As the plane is moved outwards
from the centre of the torus there is a transition of Cassini curves
from a > b (two loops) to a = b, and finally a < b (single loop).
</p>

<b>Examples</b><p>

Sphere, a = 0.1, b = 1<br>
The curve is a circle at a = 0.<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini1a.gif" width=300 height=206>
</td><td valign="top">
<img src="cassini1b.gif" width=300 height=202><p>
</td></tr></table></center>
<p>

Melon, a = 0.5, b = 1<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini2a.gif" width=300 height=202>
</td><td valign="top">
<img src="cassini2b.gif" width=300 height=190><p>
</td></tr></table> </center>
<p>

Peanut, a = 0.9, b = 1<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini3a.gif" width=300 height=203>
</td><td valign="top">
<img src="cassini3b.gif" width=300 height=194><p>
</td></tr></table></center>
<p>

a = 0.99, b = 1<br>
At a = b the curve is the same as the lemnescate of Bernoulli.<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini4a.gif" width=300 height=192>
</td><td valign="top">
<img src="cassini4b.gif" width=300 height=188><p>
</td></tr></table></center>
<p>

Egg, a = 1.01, b = 1<br>
For a > b the curve splits into two half's mirrored by the y axis.<br>
Only one half of 3D image is shown.<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini5a.gif" width=300 height=183>
</td><td valign="top">
<img src="cassini5b.gif" width=300 height=234><p>
</td></tr></table></center> 
<p>

a = 1.1, b = 1<br>
Only one half shown<br>
The separation between the two foci is 2a.<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini6a.gif" width=300 height=269>
</td><td valign="top">
<img src="cassini6b.gif" width=300 height=232><p>
</td></tr></table></center> 
<p>

Sphere, a = 2, b = 1<br>
Only one half shown<br>
<center><table width=80%><tr><td valign="top">
<img src="cassini7a.gif" width=300 height=255>
</td><td valign="top">
<img src="cassini7b.gif" width=300 height=218><p>
</td></tr></table></center>
<p>

<b>Source code</b><p>
<p align="justify">
The C source code that created the images on this page can be found
here: <a href="cassini.c">cassini.c</a>. While it creates output
geometry in a particular format, the primitives are just lines and
3D polygons so it shouldn't be difficult to modify the code to
create geometry in a format for your favourite package. The 3D
solids are formed as surfaces of revolution about the x axis.
</p>

<b>PovRay</b><p>
<p align="justify">
For PovRay users here are some examples of Cassini solids and code
to create smooth triangle models:
<a href="povcassini.c">povcassini.c</a>. The renderings here used
the init file: <a href="cassini.ini">cassini.ini</a> and the PovRay
scene file: <a href="cassini.pov">cassini.pov</a>. The output of
<a href="povcassini.c">povcassini.c</a> is piped to "cassini.inc".
</p>

<table width=80%><tr><td valign="top">
a = 1.99, b = 1<br>
<center><img src="pov1.gif" width=300 height=183></center><p>
</td><td valign="top">
a = 1.02, b = 1<br>
<center><img src="pov2.gif" width=173 height=150></center><p>
</td></tr></table>
<p>

<br><br>

<center><h1>Ellipse</h1></center>
<p><br><p>
<center><table><tr><td>
<img src="ellipse1.gif" width=400 height=400 border=0>
</td><td>
<img src="ellipse2.gif" width=400 height=400 border=0>
</td></tr></table>
</center>

<br><br>

<center>
<h1>Kissing Number</h1>
<b>Who said geometry wasn't romantic?</b><p>
Written by <a href="../index.html">Paul Bourke</a><br>
December 2001
</center>
<p><br><p>

<p align="justify">
The so called "kissing number" is the maximum number of times a sphere in
N dimensional space can touch a central sphere (all spheres
are the same size and cannot intersect another sphere).
</p>

<b>2D</b>
<p align="justify">
Consider the situation in 2 dimensions, a 2D sphere is just a circle
and it is easy to verify that the kissing number is 6. That is, at most
6 circles of equal radius can be packed around a central circle of the
same radius....try it with 7 coins all of the same denomination!
</p>

<center>
<img src="kissing2d.gif" width="365" height="337" alt="2 dimensions"><p>
</center>

<b>1D</b>
<p align="justify">
The one dimensional case is rather boring with a kissing number of 2.
</p>

<b>3D</b>
<p align="justify">
In 3 dimensions the kissing number is 12, this can be verified with
ping-pong balls and bits of masking tape to hold them together.
There is more than one way to pack the 12 spheres, the example below
is a very symmetric solution. Another method is to arrange the spheres
so their centers lie along at the vertices of an icosahedron. There does
seem to be lots of "empty" space but there isn't enough for another sphere!
</p>

<center>
<img src="kissing3d.jpg" alt="3 dimensions" width="366" height="360"><p>
</center>

<p align="justify">
For a slightly more non-symmetric example see the following coordinates
(center of each kissing sphere) and corresponding image. 
</p>
<pre>
          x            y            z
     0.25531102   0.89156330  -0.37407374
    -0.13044368  -0.77593450  -0.61717914
     0.12484695   0.78152529   0.61125401
     0.79480098  -0.47827054  -0.37356217
     0.45181161  -0.14070529   0.88094738
     0.91933526   0.36212485   0.15390992
     0.21657532  -0.92622152   0.30855928
    -0.91836971  -0.36091967  -0.16227776
    -0.62695983   0.48432758  -0.61020338
    -0.79681573   0.47329850   0.37559716
     0.22672985   0.08894927  -0.96988742
    -0.51617898  -0.41001744   0.75196074
</pre>
<center>
<img src="kissing3d2.jpg" alt="3 dimensions" width="353" height="355"><p>
</center> 

<b>Higher dimensions</b>
<p align="justify">
The kissing number is known for certain for many higher dimensions and
suspected for others. The table below gives the values for a range of
dimensions. In the cases where the maximum hasn't been proved the number
below has generally be determined by exhaustive computer searches.
The exact value for 24 dimensions was found in 1979 by
A.M. Odlyzko and N.J.A. Sloane.
</p>

<pre>
Dimension         Kissing Number
   1                           2
   2                           6
   3                          12
   4                          24
   5             at least     40  at most     44
   6             at least     72  at most     78
   7             at least    126  at most    134
   8                         240
   9             at least    306  at most    364
  10             at least    500  at most    554
  11             at least    582  at most    870
  12             at least    840  at most   1357
  13             at least   1130  at most   2069
  14             at least   1582  at most   3183
  15             at least   2564  at most   4866
  16             at least   4320  at most   7355
  17             at least   5346  at most  11072
  18             at least   7398  at most  16572
  19             at least  10688  at most  24812
  20             at least  17400  at most  36764
  21             at least  27720  at most  54584
  22             at least  49896  at most  82340
  23             at least  93150  at most 124416
  24                      196560
</pre>

<b>4D</b>
<p align="justify">
For those with an interest in 4D geometry, here are the coordinates for
a solution with 24 kissing hyperspheres.
</p>
<pre>
          x            y            z            w
     0.75380927  -0.28878253  -0.17107694  -0.56489726
    -0.75380927   0.28878253   0.17107694   0.56489726
     0.00158908   0.23980955  -0.40088438  -0.88418356
     0.88625386   0.32965258  -0.25236023   0.20542051
     0.33787744  -0.01190412  -0.92962202  -0.14662890
     0.41593183  -0.27687841   0.75854507  -0.41826836
     0.13403367   0.85824466  -0.48216766  -0.11386579
     0.33628835  -0.25171367  -0.52873764   0.73755466
     0.54837642   0.34155670   0.67726179   0.35204941
    -0.33628835   0.25171367   0.52873764  -0.73755466
     0.20384377  -0.87014878  -0.44745436  -0.03276311
     0.13244459   0.61843511  -0.08128328   0.77031777
    -0.41593183   0.27687841  -0.75854507   0.41826836
     0.75222019  -0.52859208   0.22980744   0.31928630
    -0.13244459  -0.61843511   0.08128328  -0.77031777
    -0.88625386  -0.32965258   0.25236023  -0.20542051
    -0.54837642  -0.34155670  -0.67726179  -0.35204941
    -0.20384377   0.87014878   0.44745436   0.03276311
    -0.54996550  -0.58136625  -0.27637741   0.53213415
    -0.13403367  -0.85824466   0.48216766   0.11386579
     0.54996550   0.58136625   0.27637741  -0.53213415
    -0.00158908  -0.23980955   0.40088438   0.88418356
    -0.75222019   0.52859208  -0.22980744  -0.31928630
    -0.33787744   0.01190412   0.92962202   0.14662890
</pre>

<br><br>

<table border=0 width=100%><tr><td width=50%>
<center>
<h1>Apple Surface</h1>
Graphics by <a href="../index.html">Paul Bourke</a><br>
May 2000
</center>
</td><td width=50%>
x = cos(u) (4 + 3.8 cos(v))<br>
y = sin(u) (4 + 3.8 cos(v))<br>
z = (cos(v) + sin(v) - 1) (1 + sin(v)) log(1 - pi v / 10) + 7.5 sin(v)<br>
0 <= u <= 2 pi, -pi <= v <=  pi
</td></tr></table>
<p><br><p>

<center><img src="apple1.jpg" width=600 height=600></center><p>
<center><img src="apple2.jpg" width=600 height=600></center><p>

<br><br>

<center>
<table border=0 width=100%><tr><td width=50%>
<center>
<h1>Baseball seam curve</h1>
By <a href="../index.html">Paul Bourke</a><br>
January 2001
</center>
</td><td width=50%>
x = sin(pi/2 - (pi/2 - a) cos(t)) cos(t/2 + a sin(2 t))<br>
y = sin(pi/2 - (pi/2 - a) cos(t)) sin(t/2 + a sin(2 t)) <br>
z = cos(pi/2 - (pi/2 - a) cos(t)) <br>
0 < t < 4 pi, a = 0.4 (for example)
</td></tr></table></center>
<p><br><p>

<center><img src="baseball1.gif" width=525 height=525></center><p>
<center><img src="baseball2.gif" width=592 height=592></center><p>

<b>Represented in Second Life</b><p>
<center>
<a href="knots6.png"><img src="knots6s.png" border=1 width=800 height458></a>
</center><p>

<b>Equirectangular projection</b><p>
<center>
<a href="spherical.png"><img src="spherical_s.png" width=800 height=400 border=1></a>
</center><p>

</td></tr></table>
</center>
</body>
</html>


